<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Math Adventure</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700;800;900&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet"/>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Nunito',sans-serif;background:#fdf6ee;min-height:100vh;}
    button{cursor:pointer;font-family:'Nunito',sans-serif;}
    input,textarea{font-family:'Nunito',sans-serif;}
    :root{
      --cream:#fdf6ee;--sun:#FFD166;--coral:#FF6B6B;--mint:#06D6A0;
      --sky:#4ECDC4;--blue:#2D6BE4;--navy:#1a3a6b;--purple:#9B5DE5;
      --peach:#FF9F7F;--text:#2c2c2c;--muted:#8a8a9a;--card:#fffdf9;
    }
    @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
    @keyframes pop{0%,100%{transform:scale(1)}50%{transform:scale(1.13)}}
    @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}
    @keyframes confettiFall{to{transform:translateY(110vh) rotate(720deg);opacity:0}}
    @keyframes starPop{0%{transform:scale(0) rotate(-30deg);opacity:0}60%{transform:scale(1.35) rotate(5deg)}100%{transform:scale(1) rotate(0);opacity:1}}
    .profile-edit-btn:active{transform:scale(0.97)!important;box-shadow:0 2px 10px rgba(0,0,0,0.1)!important;}
    .profile-edit-btn:hover{transform:translateY(-2px);box-shadow:0 6px 28px rgba(0,0,0,0.13)!important;}
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script>
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __copyProps = (to, from, except, desc) => {
    if (from && typeof from === "object" || typeof from === "function") {
      for (let key of __getOwnPropNames(from))
        if (!__hasOwnProp.call(to, key) && key !== except)
          __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
    }
    return to;
  };
  var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
    // If the importer is in node compatibility mode or this is not an ESM
    // file that has been converted to a CommonJS file using a Babel-
    // compatible transform (i.e. "__esModule" has not been set), then set
    // "default" to the CommonJS "module.exports" for node compatibility.
    isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
    mod
  ));
  const { useState, useEffect } = React;
  const COUNTRY_LABELS = {
    IE: {
      flag: "\u{1F1EE}\u{1F1EA}",
      name: "Ireland",
      grades: {
        "K": { label: "JI", name: "Junior Infants" },
        "1": { label: "SI", name: "Senior Infants" },
        "2": { label: "1st", name: "1st Class" },
        "3": { label: "2nd", name: "2nd Class" },
        "4": { label: "3rd", name: "3rd Class" },
        "5": { label: "4th", name: "4th Class" },
        "6": { label: "5th", name: "5th Class" },
        "7": { label: "6th", name: "6th Class" },
        "8": { label: "1Y", name: "1st Year" },
        "9": { label: "2Y", name: "2nd Year" },
        "10": { label: "3Y", name: "3rd Year (Junior Cert)" },
        "11": { label: "5Y", name: "5th Year" },
        "12": { label: "6Y", name: "6th Year (Leaving Cert)" }
      }
    },
    UK: {
      flag: "\u{1F1EC}\u{1F1E7}",
      name: "UK",
      grades: {
        "K": { label: "Rec", name: "Reception" },
        "1": { label: "Y1", name: "Year 1" },
        "2": { label: "Y2", name: "Year 2" },
        "3": { label: "Y3", name: "Year 3" },
        "4": { label: "Y4", name: "Year 4" },
        "5": { label: "Y5", name: "Year 5" },
        "6": { label: "Y6", name: "Year 6" },
        "7": { label: "Y7", name: "Year 7" },
        "8": { label: "Y8", name: "Year 8" },
        "9": { label: "Y9", name: "Year 9" },
        "10": { label: "Y10", name: "Year 10 (GCSE)" },
        "11": { label: "Y11", name: "Year 11 (GCSE)" },
        "12": { label: "Y13", name: "Year 13 (A-Level)" }
      }
    },
    US: {
      flag: "\u{1F1FA}\u{1F1F8}",
      name: "US",
      grades: {
        "K": { label: "K", name: "Kindergarten" },
        "1": { label: "G1", name: "1st Grade" },
        "2": { label: "G2", name: "2nd Grade" },
        "3": { label: "G3", name: "3rd Grade" },
        "4": { label: "G4", name: "4th Grade" },
        "5": { label: "G5", name: "5th Grade" },
        "6": { label: "G6", name: "6th Grade" },
        "7": { label: "G7", name: "7th Grade" },
        "8": { label: "G8", name: "8th Grade" },
        "9": { label: "G9", name: "9th Grade" },
        "10": { label: "G10", name: "10th Grade" },
        "11": { label: "G11", name: "11th Grade" },
        "12": { label: "G12", name: "12th Grade" }
      }
    }
  };
  function getGradeLabel(gradeId, country) {
    return COUNTRY_LABELS[country]?.grades[gradeId]?.label || gradeId;
  }
  function getGradeName(gradeId, country) {
    return COUNTRY_LABELS[country]?.grades[gradeId]?.name || `Grade ${gradeId}`;
  }
  const GRADES = [
    {
      id: "K",
      age: "4\u20135",
      color: "#FFD166",
      emoji: "\u{1F392}",
      topics: ["counting", "addition_basic", "subtraction_basic", "shapes"]
    },
    {
      id: "1",
      age: "5\u20136",
      color: "#FFB347",
      emoji: "\u{1F331}",
      topics: ["addition_basic", "subtraction_basic", "counting", "place_value_10"]
    },
    {
      id: "2",
      age: "6\u20137",
      color: "#FF9F7F",
      emoji: "\u{1F33F}",
      topics: ["addition", "subtraction", "place_value", "skip_counting"]
    },
    {
      id: "3",
      age: "7\u20138",
      color: "#06D6A0",
      emoji: "\u{1F30A}",
      topics: ["multiplication", "division", "addition", "subtraction", "fractions_intro"]
    },
    {
      id: "4",
      age: "8\u20139",
      color: "#4ECDC4",
      emoji: "\u2B50",
      topics: ["multiplication", "division", "fractions", "decimals_intro", "place_value"]
    },
    {
      id: "5",
      age: "9\u201310",
      color: "#2D6BE4",
      emoji: "\u{1F52E}",
      topics: ["multiplication", "division", "fractions", "decimals", "percentages_intro"]
    },
    {
      id: "6",
      age: "10\u201311",
      color: "#9B5DE5",
      emoji: "\u{1F680}",
      topics: ["fractions", "decimals", "percentages", "integers", "ratios"]
    },
    {
      id: "7",
      age: "11\u201312",
      color: "#E040FB",
      emoji: "\u{1F52C}",
      topics: ["integers", "ratios", "algebra_intro", "geometry_basic", "percentages"]
    },
    {
      id: "8",
      age: "12\u201313",
      color: "#FF6B6B",
      emoji: "\u{1F4D0}",
      topics: ["algebra_intro", "algebra_linear", "geometry_basic", "statistics_intro", "fractions"]
    },
    {
      id: "9",
      age: "13\u201314",
      color: "#F06292",
      emoji: "\u{1F4CA}",
      topics: ["algebra_linear", "algebra_expand", "geometry_angles", "statistics_intro", "pythagoras"]
    },
    {
      id: "10",
      age: "14\u201315",
      color: "#26C6DA",
      emoji: "\u{1F9EE}",
      topics: ["algebra_linear", "algebra_expand", "pythagoras", "trig_intro", "statistics_intro"]
    },
    {
      id: "11",
      age: "15\u201316",
      color: "#66BB6A",
      emoji: "\u{1F4C8}",
      topics: ["trig_intro", "trig_advanced", "algebra_quadratic", "statistics_advanced", "sequences"]
    },
    {
      id: "12",
      age: "16\u201318",
      color: "#8D6E63",
      emoji: "\u{1F393}",
      topics: ["algebra_quadratic", "trig_advanced", "calculus_intro", "sequences", "statistics_advanced"]
    }
  ];
  const TOPIC_LABELS = {
    counting: "Counting",
    addition_basic: "Basic Addition",
    addition: "Addition",
    subtraction_basic: "Basic Subtraction",
    subtraction: "Subtraction",
    multiplication: "Multiplication",
    division: "Division",
    place_value: "Place Value",
    place_value_10: "Place Value (10s)",
    skip_counting: "Skip Counting",
    shapes: "Shapes & Patterns",
    fractions_intro: "Intro to Fractions",
    fractions: "Fractions",
    decimals_intro: "Intro to Decimals",
    decimals: "Decimals",
    percentages_intro: "Intro to %",
    percentages: "Percentages",
    integers: "Integers",
    ratios: "Ratios",
    algebra_intro: "Intro to Algebra",
    algebra_linear: "Linear Equations",
    algebra_expand: "Expanding & Factoring",
    algebra_quadratic: "Quadratic Equations",
    geometry_basic: "Geometry Basics",
    geometry_angles: "Angles & Triangles",
    statistics_intro: "Intro to Statistics",
    statistics_advanced: "Statistics",
    pythagoras: "Pythagoras' Theorem",
    trig_intro: "Intro to Trigonometry",
    trig_advanced: "Trigonometry",
    sequences: "Sequences & Series",
    calculus_intro: "Intro to Calculus"
  };
  const TOPIC_EMOJIS = {
    counting: "\u{1F522}",
    addition_basic: "\u2795",
    addition: "\u2795",
    subtraction_basic: "\u2796",
    subtraction: "\u2796",
    multiplication: "\u2716\uFE0F",
    division: "\u2797",
    place_value: "\u{1F4CA}",
    place_value_10: "\u{1F4CA}",
    skip_counting: "\u23ED\uFE0F",
    shapes: "\u{1F537}",
    fractions_intro: "\u{1F967}",
    fractions: "\u{1F967}",
    decimals_intro: "\u{1F538}",
    decimals: "\u{1F538}",
    percentages_intro: "%",
    percentages: "%",
    integers: "\xB1",
    ratios: "\u2696\uFE0F",
    algebra_intro: "\u{1F524}",
    algebra_linear: "\u{1F4CF}",
    algebra_expand: "\u{1F513}",
    algebra_quadratic: "\u{1F4D0}",
    geometry_basic: "\u{1F4D0}",
    geometry_angles: "\u{1F4D0}",
    statistics_intro: "\u{1F4CA}",
    statistics_advanced: "\u{1F4CA}",
    pythagoras: "\u{1F4D0}",
    trig_intro: "\u{1F4D0}",
    trig_advanced: "\u{1F4D0}",
    sequences: "\u{1F522}",
    calculus_intro: "\u222B"
  };
  const TOPIC_RESOURCES = {
    counting: ["Count real objects at home \u2014 spoons, toys, steps!", "Draw a number line and point to each number", "Khan Academy Kids: Counting & Numbers"],
    addition_basic: ["Use fingers or counters to count up from the bigger number", "Make 'fact family' triangles (2+3=5, 5-3=2)", "Khan Academy: Basic Addition"],
    addition: ["Try 'make a 10' \u2014 fill up to 10 first, then add the rest", "Use base-10 blocks or draw hundreds/tens/ones", "IXL Math: Addition practice"],
    subtraction_basic: ["Start at the big number, count backwards on a number line", "Act it out with objects \u2014 take some away, count what's left", "Khan Academy: Subtraction basics"],
    subtraction: ["Check by adding your answer back to the smaller number", "Draw a number line for tricky problems", "IXL Math: Subtraction"],
    multiplication: ["Sing times tables \u2014 tons of fun songs on YouTube!", "Draw arrays: rows \xD7 columns of dots", "Multiplication.com: Games & songs"],
    division: ["Think 'how many groups of __ fit in __?'", "Use the related times table fact to help", "Khan Academy: Intro to Division"],
    place_value: ["Bundle straws into groups of 10 to see tens & ones", "Draw a chart: Hundreds | Tens | Ones", "Khan Academy: Place Value"],
    place_value_10: ["Practice with coins: 10c = 1 ten! Group objects in tens", "Write in expanded form: 47 = 40 + 7", "Khan Academy: Tens and Ones"],
    skip_counting: ["Clap or jump while skip-counting \u2014 make it physical!", "Highlight every 2nd (or 5th, 10th) number on a 100-chart", "ABCya: Skip Counting games"],
    shapes: ["Go on a shape hunt around your house!", "Draw each shape and count its sides & corners", "Khan Academy Kids: Shapes"],
    fractions_intro: ["Fold paper into equal parts and shade some in", "Use a real pizza \u2014 'How many slices out of how many total?'", "Khan Academy: Intro to Fractions"],
    fractions: ["Draw fraction bars side by side to compare", "Use fraction tiles or strips of paper", "Khan Academy: Fractions"],
    decimals_intro: ["Use money \u2014 cents are hundredths, 10c coins are tenths!", "Draw a number line from 0 to 1 split into 10 parts", "Khan Academy: Intro to Decimals"],
    decimals: ["Always line up the decimal points before adding", "Use grid paper where each small square = 0.01", "IXL: Decimals practice"],
    percentages_intro: ["Percent = out of 100. Imagine a 10\xD710 grid!", "50% = half, 25% = quarter \u2014 start with those anchors", "Khan Academy: Intro to Percentages"],
    percentages: ["To find 10%, just move the decimal one place left", "Build from 10%: 20% = double 10%, 15% = 10% + half of 10%", "IXL: Percentages"],
    integers: ["Use a number line that goes left of zero into negatives", "Think of temperature: above zero vs below zero", "Khan Academy: Negative Numbers"],
    ratios: ["Draw the ratio as coloured circles \u2014 e.g. 2 red : 3 blue", "Think of ratios as a recipe you can scale up or down", "Khan Academy: Intro to Ratios"],
    algebra_intro: ["Think of the letter as a mystery box \u2014 what number fits?", "Draw a balance scale: both sides must be equal", "Khan Academy: Intro to Algebra"],
    algebra_linear: ["Do the same thing to both sides of the equation", "Work backwards: undo each operation step by step", "Khan Academy: Linear Equations"],
    algebra_expand: ["FOIL method for brackets: First, Outer, Inner, Last", "Factoring is expanding in reverse \u2014 look for common factors", "Khan Academy: Expanding & Factoring"],
    algebra_quadratic: ["Try factoring first, then the quadratic formula if needed", "x = (\u2212b \xB1 \u221A(b\xB2\u22124ac)) / 2a \u2014 write it on a card!", "Khan Academy: Quadratic Equations"],
    geometry_basic: ["Draw diagrams \u2014 geometry is visual!", "Remember: angles in a triangle always add to 180\xB0", "Khan Academy: Basic Geometry"],
    geometry_angles: ["Angles on a straight line add to 180\xB0; full turn = 360\xB0", "Use a protractor to measure and draw angles accurately", "Khan Academy: Angles"],
    statistics_intro: ["Mean = sum \xF7 count. Median = middle value when sorted", "Draw a tally chart to organise data before calculating", "Khan Academy: Statistics Intro"],
    statistics_advanced: ["Standard deviation measures spread \u2014 not just the centre", "Draw a box-and-whisker plot to visualise the distribution", "Khan Academy: Statistics"],
    pythagoras: ["a\xB2 + b\xB2 = c\xB2 \u2014 c is always the longest side (hypotenuse)", "Draw the triangle and label sides before calculating", "Khan Academy: Pythagorean Theorem"],
    trig_intro: ["SOH-CAH-TOA \u2014 write it on your hand!", "Label O (opposite), A (adjacent), H (hypotenuse) first", "Khan Academy: Intro to Trigonometry"],
    trig_advanced: ["Know the unit circle \u2014 sin, cos, tan for key angles", "Practice converting between degrees and radians", "Khan Academy: Trigonometry"],
    sequences: ["Find the pattern first: what changes between each term?", "Arithmetic: add a fixed amount. Geometric: multiply by a fixed ratio", "Khan Academy: Sequences"],
    calculus_intro: ["Differentiation finds the slope; integration finds the area", "Power rule: d/dx(x\u207F) = nx\u207F\u207B\xB9", "Khan Academy: Calculus"]
  };
  const ENCOURAGEMENTS = {
    perfect: ["\u{1F3C6} PERFECT! You're a Math Superstar!", "\u{1F31F} Absolutely flawless \u2014 every single one!", "\u{1F4AB} 100%! You completely crushed it today!"],
    great: ["\u{1F389} Amazing work! You really know this stuff!", "\u2B50 Super impressive \u2014 you're on fire!", "\u{1F308} Brilliant job! You should feel so proud!"],
    good: ["\u{1F60A} Really nice work! You're building great skills!", "\u{1F44D} Solid effort! Every practice makes you stronger!", "\u{1F33B} Great job! You're growing more capable every day!"],
    growing: ["\u{1F4AA} You showed up and tried hard \u2014 that's the most important thing!", "\u{1F331} Every expert started exactly where you are. Keep going!", "\u{1F917} Your brain grew today \u2014 even the tricky ones make you smarter!"]
  };
  const MASTERY_THRESHOLD = 80;
  const AVATARS = ["\u{1F98B}", "\u{1F42C}", "\u{1F98A}", "\u{1F43C}", "\u{1F984}", "\u{1F438}", "\u{1F981}", "\u{1F428}", "\u{1F99C}", "\u{1F419}", "\u{1F33B}", "\u{1F31F}", "\u{1F3A8}", "\u{1F3B8}", "\u{1F680}"];
  function rnd(a, b) {
    return Math.floor(Math.random() * (b - a + 1)) + a;
  }
  function smartShuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = rnd(0, i);
      [a[i], a[j]] = [a[j], a[i]];
    }
    for (let i = 1; i < a.length; i++) {
      if (a[i].topic === a[i - 1].topic) {
        let swapIdx = -1;
        for (let k = i + 1; k < a.length; k++) {
          if (a[k].topic !== a[i - 1].topic && (i === 1 || a[k].topic !== a[i - 2]?.topic)) {
            swapIdx = k;
            break;
          }
        }
        if (swapIdx !== -1) [a[i], a[swapIdx]] = [a[swapIdx], a[i]];
      }
    }
    return a;
  }
  function generateProblem(topic, difficulty) {
    const hard = difficulty === "hard", easy = difficulty === "easy";
    let q, a, hint = "";
    switch (topic) {
      case "counting": {
        const n = easy ? rnd(2, 10) : hard ? rnd(20, 50) : rnd(10, 20);
        q = `What comes after ${n - 1}?`;
        a = n;
        break;
      }
      case "shapes": {
        const sh = [{ n: "triangle", s: 3 }, { n: "square", s: 4 }, { n: "pentagon", s: 5 }, { n: "hexagon", s: 6 }];
        const s = sh[rnd(0, sh.length - 1)];
        q = `How many sides does a ${s.n} have?`;
        a = s.s;
        break;
      }
      case "addition_basic": {
        const x = easy ? rnd(1, 5) : rnd(1, 9), y = easy ? rnd(1, 4) : rnd(1, 9);
        q = `${x} + ${y} = ?`;
        a = x + y;
        break;
      }
      case "addition": {
        const max = easy ? 20 : hard ? 999 : 99;
        const x = rnd(1, max), y = rnd(1, max);
        q = `${x} + ${y} = ?`;
        a = x + y;
        break;
      }
      case "subtraction_basic": {
        const b = easy ? rnd(2, 9) : rnd(3, 12), c = rnd(1, b);
        q = `${b} \u2212 ${c} = ?`;
        a = b - c;
        break;
      }
      case "subtraction": {
        const max = easy ? 20 : hard ? 999 : 99;
        const x = rnd(Math.ceil(max / 2), max), y = rnd(1, x);
        q = `${x} \u2212 ${y} = ?`;
        a = x - y;
        break;
      }
      case "multiplication": {
        const tMax = easy ? 5 : hard ? 12 : 10;
        const x = rnd(2, tMax), y = rnd(2, tMax);
        q = `${x} \xD7 ${y} = ?`;
        a = x * y;
        hint = "Times tables!";
        break;
      }
      case "division": {
        const d = easy ? rnd(2, 5) : hard ? rnd(2, 12) : rnd(2, 9);
        const ans = rnd(2, hard ? 12 : 9);
        q = `${d * ans} \xF7 ${d} = ?`;
        a = ans;
        break;
      }
      case "place_value":
      case "place_value_10": {
        const n = topic === "place_value_10" ? rnd(11, 99) : rnd(100, 999);
        const tens = Math.floor(n / 10) % 10;
        q = `In the number ${n},
how many tens?`;
        a = tens;
        hint = "Look at the tens place";
        break;
      }
      case "skip_counting": {
        const step = [2, 3, 5, 10][rnd(0, 3)];
        const start = step * rnd(1, 5);
        q = `${start}, ${start + step}, ${start + 2 * step}, __?`;
        a = start + 3 * step;
        hint = `Skip by ${step}s`;
        break;
      }
      case "fractions_intro": {
        const dens = [2, 3, 4];
        const d = dens[rnd(0, 2)];
        const n2 = rnd(1, d - 1);
        q = `${n2} out of ${d} equal parts.
Write the fraction:`;
        a = `${n2}/${d}`;
        break;
      }
      case "fractions": {
        const d = rnd(2, 8);
        const n1 = rnd(1, d - 1), n2 = rnd(1, d - n1);
        q = `${n1}/${d}  +  ${n2}/${d}  = ?/${d}`;
        a = n1 + n2;
        hint = "Add the top numbers!";
        break;
      }
      case "decimals_intro":
      case "decimals": {
        const x = parseFloat((rnd(10, 99) / 10).toFixed(1)), y = parseFloat((rnd(10, 99) / 10).toFixed(1));
        q = `${x} + ${y} = ?`;
        a = parseFloat((x + y).toFixed(1));
        break;
      }
      case "percentages_intro":
      case "percentages": {
        const pcts = [10, 25, 50];
        const p = pcts[rnd(0, pcts.length - 1)];
        const n2 = rnd(2, 10) * 10;
        q = `What is ${p}% of ${n2}?`;
        a = n2 * p / 100;
        hint = `${p}% = ${p}/100`;
        break;
      }
      case "integers": {
        const x = rnd(-9, 9), y = rnd(-9, 9);
        q = `${x >= 0 ? x : `(${x})`} + ${y >= 0 ? y : `(${y})`} = ?`;
        a = x + y;
        hint = "Use a number line";
        break;
      }
      case "ratios": {
        const x = rnd(1, 6), y = rnd(1, 6), m = rnd(2, 4);
        q = `${x} : ${y}  =  ? : ${y * m}`;
        a = x * m;
        hint = "Scale both parts equally";
        break;
      }
      // -- Secondary / Senior topics -------------------------------------------
      case "algebra_intro": {
        const a2 = rnd(1, 9), b2 = rnd(1, 20);
        q = `x + ${a2} = ${a2 + b2}
Find x`;
        a = b2;
        hint = "Subtract from both sides";
        break;
      }
      case "algebra_linear": {
        if (easy) {
          const a2 = rnd(2, 9), b2 = rnd(1, 20);
          q = `${a2}x = ${a2 * b2}
Find x`;
          a = b2;
          hint = "Divide both sides by " + a2;
        } else if (hard) {
          const a2 = rnd(2, 8), b2 = rnd(1, 6), c2 = rnd(1, 20);
          q = `${a2}x + ${b2} = ${a2 * c2 + b2}
Find x`;
          a = c2;
          hint = "Subtract " + b2 + ", then divide by " + a2;
        } else {
          const a2 = rnd(2, 9), b2 = rnd(2, 15);
          q = `${a2}x \u2212 ${b2} = ${a2 * rnd(2, 8) - b2}
Find x`;
          const ans2 = Math.round((parseFloat(q.split("=")[1]) + b2) / a2);
          a = ans2;
          hint = "Add " + b2 + ", then divide by " + a2;
        }
        break;
      }
      case "algebra_expand": {
        const a2 = rnd(1, 5), b2 = rnd(1, 5), c2 = rnd(1, 5), d2 = rnd(1, 5);
        if (easy) {
          q = `Expand: ${a2}(x + ${b2})`;
          a = `${a2}x + ${a2 * b2}`;
          hint = "Multiply " + a2 + " by each term";
        } else {
          q = `Expand: (x + ${b2})(x + ${d2})`;
          a = `x\xB2 + ${b2 + d2}x + ${b2 * d2}`;
          hint = "FOIL: First, Outer, Inner, Last";
        }
        break;
      }
      case "algebra_quadratic": {
        const r1 = rnd(1, 7), r2 = rnd(1, 7);
        q = `Solve: x\xB2 \u2212 ${r1 + r2}x + ${r1 * r2} = 0
Find x`;
        a = `${r1} or ${r2}`;
        hint = "Factor: (x\u2212a)(x\u2212b)=0";
        break;
      }
      case "geometry_basic": {
        const sides = rnd(3, 6);
        const angle = Math.round(180 * (sides - 2) / sides);
        q = `Interior angle of a regular ${sides}-sided polygon?`;
        a = angle;
        hint = `(${sides}\u22122) \xD7 180 \xF7 ${sides}`;
        break;
      }
      case "geometry_angles": {
        const types = [
          { q: "Angles in a triangle add to __\xB0", a: 180 },
          { q: "Angles on a straight line add to __\xB0", a: 180 },
          { q: "Angles in a full turn = __\xB0", a: 360 },
          () => {
            const x = rnd(20, 80);
            return { q: `One angle is ${x}\xB0.
Its supplement is __\xB0`, a: 180 - x, hint: "Supplementary angles add to 180\xB0" };
          },
          () => {
            const x = rnd(20, 80);
            return { q: `One angle is ${x}\xB0.
Its complement is __\xB0`, a: 90 - x, hint: "Complementary angles add to 90\xB0" };
          }
        ];
        const pick = types[rnd(0, types.length - 1)];
        const chosen = typeof pick === "function" ? pick() : pick;
        q = chosen.q;
        a = chosen.a;
        hint = chosen.hint || "";
        break;
      }
      case "statistics_intro": {
        const nums = Array.from({ length: 5 }, () => rnd(1, 20)).sort((x, y) => x - y);
        const types = ["mean", "median", "mode"];
        const type = types[rnd(0, 2)];
        if (type === "mean") {
          a = parseFloat((nums.reduce((s, n) => s + n, 0) / nums.length).toFixed(1));
          q = `Mean of:
${nums.join(", ")}`;
          hint = "Sum \xF7 count";
        } else if (type === "median") {
          a = nums[2];
          q = `Median of:
${nums.join(", ")}`;
          hint = "Middle value (already sorted!)";
        } else {
          const m = nums[rnd(1, 3)];
          const arr = [...nums, m].sort((x, y) => x - y);
          a = m;
          q = `Mode of:
${arr.join(", ")}`;
          hint = "Most frequent value";
        }
        break;
      }
      case "statistics_advanced": {
        const n1 = rnd(2, 8), n2 = rnd(2, 8), n3 = rnd(2, 8), n4 = rnd(2, 8), n5 = rnd(2, 8);
        const mean = parseFloat(((n1 + n2 + n3 + n4 + n5) / 5).toFixed(1));
        q = `Mean of ${n1}, ${n2}, ${n3}, ${n4}, ${n5}?`;
        a = mean;
        hint = "Add all, divide by 5";
        break;
      }
      case "pythagoras": {
        const triples = [[3, 4, 5], [5, 12, 13], [8, 15, 17], [6, 8, 10]];
        const [a2, b2, c2] = triples[rnd(0, triples.length - 1)];
        if (rnd(0, 1)) {
          q = `Right triangle:
a=${a2}, b=${b2}
Find c (hypotenuse)`;
          a = c2;
          hint = "c\xB2 = a\xB2 + b\xB2";
        } else {
          q = `Right triangle:
a=${a2}, c=${c2}
Find b`;
          a = b2;
          hint = "b\xB2 = c\xB2 \u2212 a\xB2";
        }
        break;
      }
      case "trig_intro": {
        const angles = [30, 45, 60];
        const ang = angles[rnd(0, 2)];
        const vals = { 30: { sin: "0.5", cos: "0.866", tan: "0.577" }, 45: { sin: "0.707", cos: "0.707", tan: "1" }, 60: { sin: "0.866", cos: "0.5", tan: "1.732" } };
        const fn = ["sin", "cos", "tan"][rnd(0, 2)];
        q = `${fn}(${ang}\xB0) = ?`;
        a = parseFloat(vals[ang][fn]);
        hint = "SOH-CAH-TOA";
        break;
      }
      case "trig_advanced": {
        const ang = [0, 30, 45, 60, 90][rnd(0, 4)];
        const fn = ["sin", "cos"][rnd(0, 1)];
        const exact = { sin: { 0: "0", 30: "\xBD", 45: "\u221A2/2", 60: "\u221A3/2", 90: "1" }, cos: { 0: "1", 30: "\u221A3/2", 45: "\u221A2/2", 60: "\xBD", 90: "0" } };
        q = `Exact value:
${fn}(${ang}\xB0) = ?`;
        a = exact[fn][ang];
        hint = "Learn the unit circle values";
        break;
      }
      case "sequences": {
        if (easy || rnd(0, 1)) {
          const first = rnd(1, 10), diff = rnd(1, 8);
          const terms = [first, first + diff, first + 2 * diff, first + 3 * diff];
          q = `${terms.join(", ")}, __?
(Arithmetic sequence)`;
          a = first + 4 * diff;
          hint = `Common difference = ${diff}`;
        } else {
          const first = rnd(1, 5), ratio = rnd(2, 3);
          const terms = [first, first * ratio, first * ratio * ratio, first * ratio * ratio * ratio];
          q = `${terms.join(", ")}, __?
(Geometric sequence)`;
          a = first * Math.pow(ratio, 4);
          hint = `Common ratio = ${ratio}`;
        }
        break;
      }
      case "calculus_intro": {
        const n2 = rnd(2, 6), c2 = rnd(1, 5);
        if (easy || rnd(0, 1)) {
          q = `Differentiate:
f(x) = ${c2}x^${n2}`;
          a = `${c2 * n2}x^${n2 - 1}`;
          hint = `Power rule: d/dx(ax\u207F) = anx^(n-1)`;
        } else {
          q = `Differentiate:
f(x) = x^${n2} + ${c2}`;
          a = `${n2}x^${n2 - 1}`;
          hint = "Constants differentiate to 0";
        }
        break;
      }
      default: {
        q = "1 + 1 = ?";
        a = 2;
      }
    }
    return { question: q, answer: a, hint, topic };
  }
  function generateChoices(correct) {
    const cs = String(correct);
    const set = /* @__PURE__ */ new Set([cs]);
    const offsets = [1, 2, 3, 5, 10, -1, -2, -3, -5, 4, -4, 7, -7];
    let tries = 0;
    while (set.size < 4 && tries < 80) {
      tries++;
      const num = parseFloat(cs);
      if (!isNaN(num)) {
        const off = offsets[rnd(0, offsets.length - 1)];
        const w = parseFloat((num + off).toFixed(2));
        if (w >= 0) set.add(String(w));
      } else if (cs.includes("/")) {
        const [n, d] = cs.split("/").map(Number);
        const wn = Math.max(1, n + rnd(-2, 2));
        const w = `${wn}/${d}`;
        if (w !== cs) set.add(w);
      }
    }
    let fill = 1;
    while (set.size < 4) {
      set.add(String(parseFloat(cs || "0") + fill * 13));
      fill++;
    }
    return [...set].sort(() => Math.random() - 0.5);
  }
  const SK = "mathAdventure_v4";
  const SK_COUNTRY = "mathAdventure_country";
  const SK_FAMILY = "mathAdventure_family";
  const SK_LABELS = "mathAdventure_labels";
  const SK_PARENT_PIN = "mathAdventure_parentPin";
  const SK_RECOVERY_EMAIL = "mathAdventure_recoveryEmail";
  function loadProfiles() {
    try {
      return JSON.parse(localStorage.getItem(SK) || "[]");
    } catch {
      return [];
    }
  }
  function saveProfiles(p) {
    try {
      localStorage.setItem(SK, JSON.stringify(p));
    } catch {
    }
  }
  function loadCountry() {
    try {
      return localStorage.getItem(SK_COUNTRY) || "IE";
    } catch {
      return "IE";
    }
  }
  function saveCountry(c) {
    try {
      localStorage.setItem(SK_COUNTRY, c);
    } catch {
    }
  }
  function loadFamilyCode() {
    try {
      return localStorage.getItem(SK_FAMILY) || null;
    } catch {
      return null;
    }
  }
  function saveFamilyCode(c) {
    try {
      localStorage.setItem(SK_FAMILY, c);
    } catch {
    }
  }
  function loadCustomLabels() {
    try {
      return JSON.parse(localStorage.getItem(SK_LABELS) || "null") || DEFAULT_MASTERY_LABELS;
    } catch {
      return DEFAULT_MASTERY_LABELS;
    }
  }
  function saveCustomLabels(l) {
    try {
      localStorage.setItem(SK_LABELS, JSON.stringify(l));
    } catch {
    }
  }
  function loadParentPin() {
    try {
      return localStorage.getItem(SK_PARENT_PIN) || "1234";
    } catch {
      return "1234";
    }
  }
  function saveParentPin(p) {
    try {
      localStorage.setItem(SK_PARENT_PIN, p);
    } catch {
    }
  }
  function loadRecoveryEmail() {
    try {
      return localStorage.getItem(SK_RECOVERY_EMAIL) || "";
    } catch {
      return "";
    }
  }
  function saveRecoveryEmail(e) {
    try {
      localStorage.setItem(SK_RECOVERY_EMAIL, e);
    } catch {
    }
  }
  function genFamilyCode() {
    const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
    let s = "MA-";
    for (let i = 0; i < 4; i++) s += chars[Math.floor(Math.random() * chars.length)];
    return s;
  }
  function makeProfile(name, gradeId, avatar) {
    return { id: Date.now() + Math.random(), name, gradeId, avatar, topicProgress: {}, quizHistory: [], createdAt: Date.now() };
  }
  const DEFAULT_MASTERY_LABELS = {
    mastered: { label: "Mastered", emoji: "\u2713", bg: "#d4f7ec", color: "#0d6e4f" },
    learning: { label: "Learning", emoji: "\u{1F4C8}", bg: "#fff3cd", color: "#856404" },
    growing: { label: "Growing", emoji: "\u{1F331}", bg: "#fde8ed", color: "#cc2244" },
    new: { label: "New", emoji: "\u2728", bg: "#f0f0f0", color: "#888" }
  };
  function getTopicMastery(profile, topic) {
    const p = profile.topicProgress[topic];
    if (!p || p.attempts < 5) return "new";
    const pct = p.correct / p.attempts * 100;
    if (pct >= MASTERY_THRESHOLD) return "mastered";
    if (pct >= 50) return "learning";
    return "growing";
  }
  function getTopicPct(profile, topic) {
    const p = profile.topicProgress[topic];
    if (!p || p.attempts === 0) return null;
    return Math.round(p.correct / p.attempts * 100);
  }
  const FIREBASE_CONFIG = {
    apiKey: "AIzaSyCxqGRhdCyh92LyiFvrTi6ETTiFKVhDvUM",
    authDomain: "homeschool-math.firebaseapp.com",
    databaseURL: "https://homeschool-math-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "homeschool-math",
    storageBucket: "homeschool-math.firebasestorage.app",
    messagingSenderId: "275309549483",
    appId: "1:275309549483:web:945998a87f4e58b96f24ee"
  };
  let _db = null;
  async function getDb() {
    if (_db) return _db;
    try {
      const { initializeApp, getApps } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
      const { getFirestore, collection, addDoc, getDocs, query, orderBy, where } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");
      const app = getApps().length ? getApps()[0] : initializeApp(FIREBASE_CONFIG);
      _db = { db: getFirestore(app), collection, addDoc, getDocs, query, orderBy, where };
      return _db;
    } catch (e) {
      console.warn("Firebase unavailable:", e);
      return null;
    }
  }
  async function submitFeedback(familyCode, entry) {
    const fb = await getDb();
    if (!fb) return false;
    try {
      const { db, collection, addDoc } = fb;
      await addDoc(collection(db, "feedback"), {
        familyCode,
        ...entry,
        ts: Date.now()
      });
      return true;
    } catch (e) {
      console.error("submitFeedback:", e);
      return false;
    }
  }
  async function loadAllFeedback() {
    const fb = await getDb();
    if (!fb) return [];
    try {
      const { db, collection, getDocs, query, orderBy } = fb;
      const snap = await getDocs(query(collection(db, "feedback"), orderBy("ts", "desc")));
      return snap.docs.map((d) => ({ id: d.id, ...d.data() }));
    } catch (e) {
      console.error("loadAllFeedback:", e);
      return [];
    }
  }
  async function loadFamilyFromFirebase(familyCode) {
    const fb = await getDb();
    if (!fb) return null;
    try {
      const { db, collection, getDocs, query, where, orderBy } = fb;
      const snap = await getDocs(
        query(collection(db, "families"), where("familyCode", "==", familyCode), orderBy("ts", "desc"))
      );
      if (snap.empty) return null;
      return snap.docs[0].data().profiles || null;
    } catch (e) {
      console.warn("loadFamilyFromFirebase:", e);
      return null;
    }
  }
  const ADMIN_PIN_HASH = "9999";
  function Page({ children }) {
    return /* @__PURE__ */ React.createElement("div", { style: {
      minHeight: "100vh",
      background: "linear-gradient(160deg,#fdf6ee 0%,#f0f8ff 50%,#fef0f5 100%)",
      backgroundAttachment: "fixed",
      padding: "16px"
    } }, /* @__PURE__ */ React.createElement("div", { style: { maxWidth: 600, margin: "0 auto" } }, children));
  }
  function ProgressBar({ pct, color = "#06D6A0", height = 10 }) {
    return /* @__PURE__ */ React.createElement("div", { style: { background: "#eee", borderRadius: 30, height, overflow: "hidden", flex: 1, minWidth: 40 } }, /* @__PURE__ */ React.createElement("div", { style: {
      width: `${Math.min(100, Math.max(0, pct))}%`,
      height: "100%",
      borderRadius: 30,
      background: `linear-gradient(90deg,${color}88,${color})`,
      transition: "width 0.6s ease"
    } }));
  }
  function MasteryBadge({ status, labels }) {
    const map = labels || DEFAULT_MASTERY_LABELS;
    const s = map[status] || map.new;
    return /* @__PURE__ */ React.createElement("span", { style: {
      background: s.bg,
      color: s.color,
      borderRadius: 20,
      padding: "3px 10px",
      fontSize: "0.72rem",
      fontWeight: 800,
      whiteSpace: "nowrap"
    } }, s.label, " ", s.emoji);
  }
  function Stars({ count, max = 3 }) {
    return /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 6, justifyContent: "center", margin: "8px 0" } }, Array.from({ length: max }, (_, i) => /* @__PURE__ */ React.createElement("span", { key: i, style: {
      fontSize: "2rem",
      animation: i < count ? `starPop 0.4s ${i * 0.15}s ease both` : "none",
      opacity: i < count ? 1 : 0.2,
      filter: i < count ? "none" : "grayscale(1)"
    } }, "\u2B50")));
  }
  function Confetti() {
    const pieces = Array.from({ length: 32 }, (_, i) => ({
      id: i,
      x: Math.random() * 100,
      color: ["#FFD166", "#06D6A0", "#FF6B6B", "#9B5DE5", "#4ECDC4", "#2D6BE4"][i % 6],
      size: rnd(8, 16),
      delay: Math.random() * 1.2,
      dur: 1.4 + Math.random() * 1.4
    }));
    return /* @__PURE__ */ React.createElement("div", { style: { position: "fixed", inset: 0, pointerEvents: "none", overflow: "hidden", zIndex: 999 } }, pieces.map((p) => /* @__PURE__ */ React.createElement("div", { key: p.id, style: {
      position: "absolute",
      left: `${p.x}%`,
      top: "-20px",
      width: p.size,
      height: p.size,
      borderRadius: "3px",
      background: p.color,
      animation: `confettiFall ${p.dur}s ${p.delay}s ease-in forwards`
    } })));
  }
  function FeedbackWidget({ familyCode, profiles }) {
    const [open, setOpen] = useState(false);
    const [stars, setStars] = useState(0);
    const [hover, setHover] = useState(0);
    const [comment, setComment] = useState("");
    const [who, setWho] = useState("");
    const [sending, setSending] = useState(false);
    const [sent, setSent] = useState(false);
    const handleSubmit = async () => {
      if (!stars) return;
      setSending(true);
      const ok = await submitFeedback(familyCode, {
        stars,
        comment: comment.trim(),
        who: who.trim() || "Anonymous",
        profileCount: profiles.length
      });
      setSending(false);
      if (ok !== false) {
        setSent(true);
        setTimeout(() => {
          setSent(false);
          setOpen(false);
          setStars(0);
          setComment("");
          setWho("");
        }, 2200);
      }
    };
    return /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(
      "button",
      {
        onClick: () => setOpen(true),
        style: {
          position: "fixed",
          bottom: 20,
          right: 20,
          zIndex: 800,
          background: "linear-gradient(135deg,#FFD166,#FF9F7F)",
          border: "none",
          borderRadius: "50%",
          width: 52,
          height: 52,
          fontSize: "1.5rem",
          boxShadow: "0 4px 18px rgba(255,160,60,0.45)",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          cursor: "pointer",
          transition: "transform 0.15s"
        },
        onMouseEnter: (e) => e.currentTarget.style.transform = "scale(1.12)",
        onMouseLeave: (e) => e.currentTarget.style.transform = "scale(1)",
        title: "Leave feedback"
      },
      "\u2B50"
    ), open && /* @__PURE__ */ React.createElement(
      "div",
      {
        style: {
          position: "fixed",
          inset: 0,
          background: "rgba(0,0,0,0.45)",
          zIndex: 900,
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          padding: 16
        },
        onClick: (e) => {
          if (e.target === e.currentTarget) setOpen(false);
        }
      },
      /* @__PURE__ */ React.createElement("div", { style: {
        background: "#fffdf9",
        borderRadius: 24,
        padding: 28,
        maxWidth: 400,
        width: "100%",
        boxShadow: "0 8px 40px rgba(0,0,0,0.18)",
        animation: "fadeUp 0.3s ease"
      } }, sent ? /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", padding: "20px 0" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3rem", marginBottom: 10 } }, "\u{1F389}"), /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.4rem", fontWeight: 800, color: "var(--navy)" } }, "Thank you so much!"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, marginTop: 6 } }, "Your feedback helps us improve.")) : /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.25rem", fontWeight: 800, color: "var(--navy)", marginBottom: 4 } }, "\u2B50 How are we doing?"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.85rem", marginBottom: 16, lineHeight: 1.5 } }, "We'd love to hear from you! Your feedback helps make Math Adventure better for every family."), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 6, justifyContent: "center", marginBottom: 16 } }, [1, 2, 3, 4, 5].map((n) => /* @__PURE__ */ React.createElement(
        "button",
        {
          key: n,
          onClick: () => setStars(n),
          onMouseEnter: () => setHover(n),
          onMouseLeave: () => setHover(0),
          style: {
            fontSize: "2.2rem",
            border: "none",
            background: "transparent",
            cursor: "pointer",
            transition: "transform 0.1s",
            transform: (hover || stars) >= n ? "scale(1.2)" : "scale(1)",
            filter: (hover || stars) >= n ? "none" : "grayscale(1) opacity(0.35)"
          }
        },
        "\u2B50"
      ))), stars > 0 && /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", fontSize: "0.8rem", fontWeight: 700, color: "var(--muted)", marginBottom: 12 } }, ["", "\u{1F61E} That's tough to hear", "\u{1F610} Room to improve", "\u{1F642} Glad it's helping", "\u{1F60A} That's great!", "\u{1F929} You made our day!"][stars]), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Your name (optional)"), /* @__PURE__ */ React.createElement(
        "input",
        {
          style: { ...S.input, marginBottom: 12 },
          placeholder: "e.g. Emma or Dad",
          value: who,
          onChange: (e) => setWho(e.target.value),
          maxLength: 30
        }
      ), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Comments (optional)"), /* @__PURE__ */ React.createElement(
        "textarea",
        {
          value: comment,
          onChange: (e) => setComment(e.target.value),
          placeholder: "What do you love? What could be better? Any topic requests?",
          maxLength: 400,
          style: { ...S.input, height: 90, resize: "vertical", marginBottom: 20, fontFamily: "Nunito,sans-serif", lineHeight: 1.5 }
        }
      ), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 10 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, flex: 1 }, onClick: () => setOpen(false) }, "Cancel"), /* @__PURE__ */ React.createElement(
        "button",
        {
          style: {
            ...S.btnPrimary,
            flex: 2,
            opacity: stars && !sending ? 1 : 0.45
          },
          disabled: !stars || sending,
          onClick: handleSubmit
        },
        sending ? "Sending\u2026" : "Send Feedback \u2708\uFE0F"
      ))))
    ));
  }
  function PinModal({ title, subtitle, correctPin, onSuccess, onCancel }) {
    const [digits, setDigits] = useState("");
    const [err, setErr] = useState(false);
    const submit = () => {
      if (digits === correctPin) {
        onSuccess();
      } else {
        setErr(true);
        setDigits("");
        setTimeout(() => setErr(false), 800);
      }
    };
    return /* @__PURE__ */ React.createElement("div", { style: {
      position: "fixed",
      inset: 0,
      background: "rgba(0,0,0,0.5)",
      zIndex: 950,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      padding: 16
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      background: "#fffdf9",
      borderRadius: 24,
      padding: 28,
      maxWidth: 340,
      width: "100%",
      animation: `${err ? "shake" : "fadeUp"} 0.3s ease`,
      boxShadow: "0 8px 40px rgba(0,0,0,0.2)"
    } }, /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", marginBottom: 16 } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "2.5rem", marginBottom: 6 } }, "\u{1F512}"), /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.2rem", fontWeight: 800, color: "var(--navy)" } }, title), subtitle && /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontSize: "0.83rem", fontWeight: 600, marginTop: 4 } }, subtitle)), /* @__PURE__ */ React.createElement(
      "input",
      {
        type: "password",
        inputMode: "numeric",
        maxLength: 6,
        value: digits,
        onChange: (e) => setDigits(e.target.value.replace(/\D/g, "")),
        onKeyDown: (e) => e.key === "Enter" && submit(),
        autoFocus: true,
        style: { ...S.input, textAlign: "center", fontSize: "1.4rem", letterSpacing: 6, marginBottom: 16 },
        placeholder: "\u2022\u2022\u2022\u2022"
      }
    ), err && /* @__PURE__ */ React.createElement("div", { style: { color: "var(--coral)", fontWeight: 700, fontSize: "0.83rem", textAlign: "center", marginBottom: 8 } }, "Incorrect PIN \u2014 try again"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 10 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, flex: 1 }, onClick: onCancel }, "Cancel"), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnPrimary, flex: 2 }, onClick: submit }, "Unlock"))));
  }
  function FamilySetup({ onComplete }) {
    const [mode, setMode] = useState("choice");
    const [code, setCode] = useState("");
    const [loading, setLoading] = useState(false);
    const [err, setErr] = useState("");
    const createFamily = () => {
      const fc = genFamilyCode();
      saveFamilyCode(fc);
      onComplete(fc);
    };
    const joinFamily = async () => {
      const trimmed = code.trim().toUpperCase();
      if (trimmed.length < 5) {
        setErr("Please enter a valid family code.");
        return;
      }
      setLoading(true);
      setErr("");
      const remoteProfiles = await loadFamilyFromFirebase(trimmed);
      setLoading(false);
      if (remoteProfiles) {
        saveFamilyCode(trimmed);
        saveProfiles(remoteProfiles);
        onComplete(trimmed, remoteProfiles);
      } else {
        saveFamilyCode(trimmed);
        onComplete(trimmed, null);
      }
    };
    return /* @__PURE__ */ React.createElement("div", { style: {
      position: "fixed",
      inset: 0,
      background: "linear-gradient(160deg,#fdf6ee,#f0f8ff)",
      zIndex: 980,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      padding: 20
    } }, /* @__PURE__ */ React.createElement("div", { style: { ...S.card, maxWidth: 420, width: "100%", textAlign: "center", animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3rem", marginBottom: 8 } }, "\u{1F468}\u200D\u{1F469}\u200D\u{1F467}\u200D\u{1F467}"), /* @__PURE__ */ React.createElement("h1", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.8rem", fontWeight: 900, color: "var(--navy)", marginBottom: 4 } }, "Welcome to Math Adventure!"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.9rem", lineHeight: 1.6, marginBottom: 24 } }, "Create a Family Code to get started, or join an existing family to share profiles across devices."), mode === "choice" ? /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("button", { style: { ...S.btnPrimary, width: "100%", marginBottom: 12 }, onClick: createFamily }, "\u{1F3E0} Create a New Family"), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, width: "100%" }, onClick: () => setMode("join") }, "\u{1F517} Join with Family Code")) : /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("label", { style: { ...S.inputLabel, textAlign: "left" } }, "Family Code"), /* @__PURE__ */ React.createElement(
      "input",
      {
        style: { ...S.input, textAlign: "center", fontSize: "1.2rem", letterSpacing: 3, textTransform: "uppercase" },
        placeholder: "e.g. MA-WXYZ",
        value: code,
        onChange: (e) => setCode(e.target.value.toUpperCase()),
        onKeyDown: (e) => e.key === "Enter" && joinFamily(),
        maxLength: 10
      }
    ), err && /* @__PURE__ */ React.createElement("div", { style: { color: "var(--coral)", fontWeight: 700, fontSize: "0.82rem", marginBottom: 8 } }, err), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 10, marginTop: 8 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, flex: 1 }, onClick: () => setMode("choice") }, "\u2190 Back"), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnPrimary, flex: 2, opacity: loading ? 0.5 : 1 }, disabled: loading, onClick: joinFamily }, loading ? "Joining\u2026" : "Join Family \u2192")))));
  }
  function AdminPanel({ onClose }) {
    const [feedback, setFeedback] = useState(null);
    const [filter, setFilter] = useState(0);
    useEffect(() => {
      loadAllFeedback().then(setFeedback);
    }, []);
    const shown = feedback ? feedback.filter((f) => filter === 0 || f.stars === filter) : null;
    const avg = feedback && feedback.length ? (feedback.reduce((s, f) => s + f.stars, 0) / feedback.length).toFixed(1) : "\u2014";
    return /* @__PURE__ */ React.createElement("div", { style: {
      position: "fixed",
      inset: 0,
      background: "rgba(0,0,0,0.6)",
      zIndex: 970,
      display: "flex",
      alignItems: "flex-start",
      justifyContent: "center",
      padding: 16,
      overflowY: "auto"
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      background: "#fffdf9",
      borderRadius: 24,
      padding: 24,
      maxWidth: 640,
      width: "100%",
      marginTop: 20,
      boxShadow: "0 8px 40px rgba(0,0,0,0.25)",
      animation: "fadeUp 0.3s ease"
    } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 16 } }, /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.4rem", fontWeight: 800, color: "var(--navy)" } }, "\u{1F6E1}\uFE0F Admin \u2014 All Feedback"), /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onClose }, "\u2715 Close")), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 10, marginBottom: 16, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("div", { style: { background: "#eaf0ff", borderRadius: 16, padding: "10px 18px", fontWeight: 800, color: "var(--blue)", fontSize: "0.9rem" } }, "\u{1F4DD} ", feedback?.length ?? "\u2026", " reviews"), /* @__PURE__ */ React.createElement("div", { style: { background: "#fff8e1", borderRadius: 16, padding: "10px 18px", fontWeight: 800, color: "#856404", fontSize: "0.9rem" } }, "\u2B50 Avg ", avg)), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 6, marginBottom: 16, flexWrap: "wrap" } }, [0, 5, 4, 3, 2, 1].map((n) => /* @__PURE__ */ React.createElement("button", { key: n, onClick: () => setFilter(n), style: {
      border: `2px solid ${filter === n ? "var(--blue)" : "#e0e0e0"}`,
      background: filter === n ? "#eaf0ff" : "#fafafa",
      borderRadius: 20,
      padding: "5px 12px",
      fontWeight: 700,
      fontSize: "0.8rem",
      color: filter === n ? "var(--blue)" : "var(--muted)"
    } }, n === 0 ? "All" : `${"\u2B50".repeat(n)}`))), shown === null ? /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", padding: 32, color: "var(--muted)", fontWeight: 600 } }, "Loading\u2026") : shown.length === 0 ? /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", padding: 32, color: "var(--muted)", fontWeight: 600 } }, "No feedback yet.") : /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 10, maxHeight: 500, overflowY: "auto" } }, shown.map((f) => /* @__PURE__ */ React.createElement("div", { key: f.id, style: { background: "#f9f9f9", borderRadius: 14, padding: "12px 16px", border: "1px solid #eee" } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 4, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.95rem" } }, "\u2B50".repeat(f.stars)), /* @__PURE__ */ React.createElement("span", { style: { fontWeight: 800, fontSize: "0.85rem", color: "var(--navy)" } }, f.who || "Anonymous"), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.72rem", color: "var(--muted)", marginLeft: "auto" } }, new Date(f.ts).toLocaleDateString()), /* @__PURE__ */ React.createElement("span", { style: {
      background: "#eaf0ff",
      color: "var(--blue)",
      borderRadius: 20,
      padding: "2px 8px",
      fontSize: "0.7rem",
      fontWeight: 700
    } }, f.familyCode)), f.comment && /* @__PURE__ */ React.createElement("p", { style: { fontSize: "0.83rem", color: "var(--text)", lineHeight: 1.5, margin: 0 } }, f.comment))))));
  }
  function ParentPanel({ profiles, country, familyCode, labels, onUpdateLabels, onClose }) {
    const [tab, setTab] = useState("overview");
    const [editLabels, setEditLabels] = useState(JSON.parse(JSON.stringify(labels)));
    const [labelSaved, setLabelSaved] = useState(false);
    const [selectedProfile, setSelectedProfile] = useState(null);
    const [pinTab, setPinTab] = useState(false);
    const [newPin, setNewPin] = useState("");
    const [confirmPin, setConfirmPin] = useState("");
    const [pinEmail, setPinEmail] = useState(() => loadRecoveryEmail());
    const [pinErr, setPinErr] = useState("");
    const [pinSaved, setPinSaved] = useState(false);
    const isDefaultPin = loadParentPin() === "1234";
    const handleSaveLabels = () => {
      onUpdateLabels(editLabels);
      setLabelSaved(true);
      setTimeout(() => setLabelSaved(false), 2e3);
    };
    const handleSavePin = () => {
      if (newPin.length < 4) {
        setPinErr("PIN must be at least 4 digits.");
        return;
      }
      if (newPin !== confirmPin) {
        setPinErr("PINs don't match \u2014 try again.");
        return;
      }
      saveParentPin(newPin);
      if (pinEmail.trim()) saveRecoveryEmail(pinEmail.trim());
      setPinErr("");
      setPinSaved(true);
      setNewPin("");
      setConfirmPin("");
      setTimeout(() => {
        setPinSaved(false);
        setPinTab(false);
      }, 2200);
    };
    if (selectedProfile) {
      const profile = selectedProfile;
      const grade = GRADES.find((g) => g.id === profile.gradeId);
      const gName = getGradeName(profile.gradeId, country);
      const topics = grade?.topics || [];
      const recent = profile.quizHistory.slice(-10).reverse();
      return /* @__PURE__ */ React.createElement("div", { style: {
        position: "fixed",
        inset: 0,
        background: "rgba(0,0,0,0.55)",
        zIndex: 960,
        display: "flex",
        alignItems: "flex-start",
        justifyContent: "center",
        padding: 16,
        overflowY: "auto"
      } }, /* @__PURE__ */ React.createElement("div", { style: {
        background: "#fffdf9",
        borderRadius: 24,
        padding: 24,
        maxWidth: 600,
        width: "100%",
        marginTop: 20,
        boxShadow: "0 8px 40px rgba(0,0,0,0.2)",
        animation: "fadeUp 0.3s ease"
      } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 12, marginBottom: 20 } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: () => setSelectedProfile(null) }, "\u2190 Back"), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "2rem" } }, profile.avatar), /* @__PURE__ */ React.createElement("div", null, /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.2rem", fontWeight: 800, color: "var(--navy)" } }, profile.name), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.78rem", color: "var(--muted)", fontWeight: 600 } }, grade?.emoji, " ", gName, " \xB7 Age ", grade?.age))), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 12 } }, topics.map((t) => {
        const status = getTopicMastery(profile, t);
        const pct = getTopicPct(profile, t);
        const prog = profile.topicProgress[t];
        return /* @__PURE__ */ React.createElement("div", { key: t, style: {
          padding: "10px 14px",
          borderRadius: 14,
          background: status === "mastered" ? "#f0faf5" : status === "learning" ? "#fffbec" : status === "growing" ? "#fff0f3" : "#f8f8f8",
          border: `1.5px solid ${status === "mastered" ? "#b6eedd" : status === "learning" ? "#ffe9a0" : status === "growing" ? "#ffc8d2" : "#e8e8e8"}`
        } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8, marginBottom: pct !== null ? 6 : 0 } }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "1rem" } }, TOPIC_EMOJIS[t]), /* @__PURE__ */ React.createElement("span", { style: { fontWeight: 700, fontSize: "0.87rem", flex: 1 } }, TOPIC_LABELS[t]), /* @__PURE__ */ React.createElement(MasteryBadge, { status, labels })), prog && prog.attempts > 0 && /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(ProgressBar, { pct: pct || 0, color: grade?.color || "#06D6A0" }), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.7rem", color: "var(--muted)", fontWeight: 700, marginTop: 3 } }, prog.correct, "/", prog.attempts, " correct (", pct, "%)")));
      })), recent.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { marginTop: 20 } }, /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontWeight: 800, color: "var(--navy)", marginBottom: 10 } }, "Recent Quizzes"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 6 } }, recent.map((q, i) => /* @__PURE__ */ React.createElement("div", { key: i, style: {
        display: "flex",
        alignItems: "center",
        gap: 10,
        padding: "8px 12px",
        background: "#f9f9f9",
        borderRadius: 12
      } }, /* @__PURE__ */ React.createElement("div", { style: { flex: 1 } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.84rem" } }, q.score, "/", q.total, " (", q.pct, "%)"), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.7rem", color: "var(--muted)", fontWeight: 600 } }, new Date(q.date).toLocaleDateString("en-IE", { day: "numeric", month: "short", year: "numeric" }))), /* @__PURE__ */ React.createElement(
        ProgressBar,
        {
          pct: q.pct,
          height: 6,
          color: q.pct >= 80 ? "#06D6A0" : q.pct >= 50 ? "#FFD166" : "#FF9F7F"
        }
      ), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.85rem", minWidth: 36 } }, "\u2B50".repeat(q.pct >= 95 ? 3 : q.pct >= 75 ? 2 : q.pct >= 50 ? 1 : 0))))))));
    }
    if (pinTab) {
      return /* @__PURE__ */ React.createElement("div", { style: {
        position: "fixed",
        inset: 0,
        background: "rgba(0,0,0,0.55)",
        zIndex: 960,
        display: "flex",
        alignItems: "flex-start",
        justifyContent: "center",
        padding: 16,
        overflowY: "auto"
      } }, /* @__PURE__ */ React.createElement("div", { style: {
        background: "#fffdf9",
        borderRadius: 24,
        padding: 24,
        maxWidth: 420,
        width: "100%",
        marginTop: 20,
        boxShadow: "0 8px 40px rgba(0,0,0,0.2)",
        animation: "fadeUp 0.3s ease"
      } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10, marginBottom: 20 } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: () => {
        setPinTab(false);
        setPinErr("");
      } }, "\u2190 Back"), /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.2rem", fontWeight: 800, color: "var(--navy)" } }, "\u{1F511} Change Parent PIN")), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.85rem", marginBottom: 20, lineHeight: 1.6 } }, "Choose a new PIN for Parent & Teacher Mode. Anyone with this PIN can view all learner progress and settings."), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "New PIN (4\u20136 digits)"), /* @__PURE__ */ React.createElement(
        "input",
        {
          type: "password",
          inputMode: "numeric",
          maxLength: 6,
          style: { ...S.input, textAlign: "center", fontSize: "1.3rem", letterSpacing: 6 },
          value: newPin,
          onChange: (e) => setNewPin(e.target.value.replace(/\D/g, "")),
          placeholder: "\u2022\u2022\u2022\u2022"
        }
      ), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Confirm New PIN"), /* @__PURE__ */ React.createElement(
        "input",
        {
          type: "password",
          inputMode: "numeric",
          maxLength: 6,
          style: { ...S.input, textAlign: "center", fontSize: "1.3rem", letterSpacing: 6 },
          value: confirmPin,
          onChange: (e) => setConfirmPin(e.target.value.replace(/\D/g, "")),
          placeholder: "\u2022\u2022\u2022\u2022"
        }
      ), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Recovery Email (optional)"), /* @__PURE__ */ React.createElement(
        "input",
        {
          type: "email",
          inputMode: "email",
          style: S.input,
          value: pinEmail,
          onChange: (e) => setPinEmail(e.target.value),
          placeholder: "e.g. parent@email.com"
        }
      ), /* @__PURE__ */ React.createElement("p", { style: { fontSize: "0.73rem", color: "var(--muted)", fontWeight: 600, marginTop: -10, marginBottom: 16, lineHeight: 1.5 } }, "If you forget your PIN, we'll show this email as a reminder of where to look. Your email is stored only on this device."), pinErr && /* @__PURE__ */ React.createElement("div", { style: { color: "var(--coral)", fontWeight: 700, fontSize: "0.83rem", marginBottom: 12, textAlign: "center" } }, pinErr), pinSaved && /* @__PURE__ */ React.createElement("div", { style: { color: "#0d6e4f", fontWeight: 800, fontSize: "0.9rem", marginBottom: 12, textAlign: "center" } }, "\u2713 PIN saved!"), /* @__PURE__ */ React.createElement(
        "button",
        {
          style: { ...S.btnPrimary, width: "100%", opacity: newPin.length >= 4 && confirmPin.length >= 4 ? 1 : 0.45 },
          disabled: newPin.length < 4 || confirmPin.length < 4,
          onClick: handleSavePin
        },
        "Save New PIN \u{1F511}"
      )));
    }
    return /* @__PURE__ */ React.createElement("div", { style: {
      position: "fixed",
      inset: 0,
      background: "rgba(0,0,0,0.55)",
      zIndex: 960,
      display: "flex",
      alignItems: "flex-start",
      justifyContent: "center",
      padding: 16,
      overflowY: "auto"
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      background: "#fffdf9",
      borderRadius: 24,
      padding: 24,
      maxWidth: 600,
      width: "100%",
      marginTop: 20,
      boxShadow: "0 8px 40px rgba(0,0,0,0.2)",
      animation: "fadeUp 0.3s ease"
    } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 4 } }, /* @__PURE__ */ React.createElement("div", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.3rem", fontWeight: 800, color: "var(--navy)" } }, "\u{1F468}\u200D\u{1F469}\u200D\u{1F467} Parent & Teacher Mode"), /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onClose }, "\u2715 Close")), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.78rem", color: "var(--muted)", fontWeight: 600, marginBottom: 16, display: "flex", alignItems: "center", flexWrap: "wrap", gap: 8 } }, /* @__PURE__ */ React.createElement("span", null, "Family code: ", /* @__PURE__ */ React.createElement("strong", { style: { color: "var(--navy)", letterSpacing: 2 } }, familyCode), /* @__PURE__ */ React.createElement("span", { style: { marginLeft: 6, opacity: 0.7 } }, "\xB7 Share so family can join on other devices")), /* @__PURE__ */ React.createElement("button", { onClick: () => setPinTab(true), style: {
      background: isDefaultPin ? "#fff8e1" : "#f0f0f0",
      border: `1.5px solid ${isDefaultPin ? "#FFD166" : "#ddd"}`,
      borderRadius: 20,
      padding: "3px 10px",
      fontSize: "0.72rem",
      fontWeight: 800,
      color: isDefaultPin ? "#856404" : "var(--muted)",
      cursor: "pointer",
      flexShrink: 0
    } }, isDefaultPin ? "\u26A0\uFE0F Change PIN" : "\u{1F511} Change PIN")), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, marginBottom: 20 } }, [["overview", "\u{1F4CA} Overview"], ["labels", "\u{1F3F7}\uFE0F Custom Labels"]].map(([t, l]) => /* @__PURE__ */ React.createElement("button", { key: t, onClick: () => setTab(t), style: {
      border: `2px solid ${tab === t ? "var(--blue)" : "#e0e0e0"}`,
      background: tab === t ? "#eaf0ff" : "#fafafa",
      borderRadius: 20,
      padding: "7px 16px",
      fontWeight: 800,
      fontSize: "0.85rem",
      color: tab === t ? "var(--blue)" : "var(--muted)"
    } }, l))), tab === "overview" && /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 12 } }, profiles.map((profile) => {
      const grade = GRADES.find((g) => g.id === profile.gradeId);
      const gName = getGradeName(profile.gradeId, country);
      const topics = grade?.topics || [];
      const topicStats = topics.map((t) => ({ t, status: getTopicMastery(profile, t), pct: getTopicPct(profile, t) }));
      const strengths = topicStats.filter((x) => x.status === "mastered");
      const weak = topicStats.filter((x) => x.status === "growing");
      const inProg = topicStats.filter((x) => x.status === "learning");
      const recent = profile.quizHistory.slice(-3).reverse();
      return /* @__PURE__ */ React.createElement(
        "button",
        {
          key: profile.id,
          onClick: () => setSelectedProfile(profile),
          style: {
            border: `2px solid ${grade?.color || "#eee"}`,
            borderRadius: 18,
            padding: 16,
            background: `linear-gradient(135deg,${grade?.color || "#eee"}11,#fff)`,
            textAlign: "left",
            cursor: "pointer",
            fontFamily: "Nunito,sans-serif",
            width: "100%"
          }
        },
        /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 10, marginBottom: strengths.length || inProg.length || weak.length ? 10 : 0 } }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "2rem" } }, profile.avatar), /* @__PURE__ */ React.createElement("div", { style: { flex: 1 } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "1rem", color: "var(--navy)" } }, profile.name), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.78rem", color: "var(--muted)", fontWeight: 600 } }, grade?.emoji, " ", gName, " \xB7 Age ", grade?.age)), /* @__PURE__ */ React.createElement("div", { style: { textAlign: "right" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.72rem", color: "var(--muted)", fontWeight: 600 } }, profile.quizHistory.length, " quizzes"), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.72rem", color: "var(--blue)", fontWeight: 700, marginTop: 2 } }, "View detail \u2192"))),
        strengths.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { marginBottom: 6 } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.68rem", fontWeight: 800, color: "#0d6e4f", marginBottom: 3, textTransform: "uppercase" } }, "\u{1F4AA} Strengths"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 3 } }, strengths.map((x) => /* @__PURE__ */ React.createElement("span", { key: x.t, style: { background: "#d4f7ec", color: "#0d6e4f", borderRadius: 20, padding: "1px 8px", fontSize: "0.7rem", fontWeight: 700 } }, TOPIC_EMOJIS[x.t], " ", TOPIC_LABELS[x.t])))),
        inProg.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { marginBottom: 6 } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.68rem", fontWeight: 800, color: "#856404", marginBottom: 3, textTransform: "uppercase" } }, "\u{1F4C8} In Progress"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 3 } }, inProg.map((x) => /* @__PURE__ */ React.createElement("span", { key: x.t, style: { background: "#fff3cd", color: "#856404", borderRadius: 20, padding: "1px 8px", fontSize: "0.7rem", fontWeight: 700 } }, TOPIC_EMOJIS[x.t], " ", TOPIC_LABELS[x.t], x.pct !== null ? ` ${x.pct}%` : "")))),
        weak.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { marginBottom: 6 } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.68rem", fontWeight: 800, color: "#cc2244", marginBottom: 3, textTransform: "uppercase" } }, "\u{1F3AF} Needs Attention"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 3 } }, weak.map((x) => /* @__PURE__ */ React.createElement("span", { key: x.t, style: { background: "#fde8ed", color: "#cc2244", borderRadius: 20, padding: "1px 8px", fontSize: "0.7rem", fontWeight: 700 } }, TOPIC_EMOJIS[x.t], " ", TOPIC_LABELS[x.t], x.pct !== null ? ` ${x.pct}%` : "")))),
        recent.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 5, flexWrap: "wrap", marginTop: 4 } }, recent.map((q, i) => /* @__PURE__ */ React.createElement("span", { key: i, style: { background: "#f0f0f0", borderRadius: 10, padding: "2px 8px", fontSize: "0.7rem", fontWeight: 700, color: "var(--text)" } }, q.pct, "%")))
      );
    })), tab === "labels" && /* @__PURE__ */ React.createElement("div", null, /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.85rem", marginBottom: 16, lineHeight: 1.5 } }, "Rename the progress labels shown to students. Use words that feel encouraging and right for your family."), ["mastered", "learning", "growing", "new"].map((key) => {
      const def = DEFAULT_MASTERY_LABELS[key];
      const cur = editLabels[key];
      return /* @__PURE__ */ React.createElement("div", { key, style: { marginBottom: 14, padding: "12px 14px", borderRadius: 14, background: "#fafafa", border: "1.5px solid #eee" } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 8 } }, /* @__PURE__ */ React.createElement("span", { style: {
        background: def.bg,
        color: def.color,
        borderRadius: 20,
        padding: "3px 10px",
        fontSize: "0.75rem",
        fontWeight: 800,
        minWidth: 90,
        textAlign: "center"
      } }, "Default: ", def.label), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.78rem", color: "var(--muted)", fontWeight: 600 } }, "\u2192 rename to:")), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, alignItems: "center" } }, /* @__PURE__ */ React.createElement(
        "input",
        {
          style: { ...S.input, marginBottom: 0, flex: 2 },
          value: cur.label,
          onChange: (e) => setEditLabels((prev) => ({ ...prev, [key]: { ...prev[key], label: e.target.value } })),
          placeholder: def.label,
          maxLength: 20
        }
      ), /* @__PURE__ */ React.createElement(
        "input",
        {
          style: { ...S.input, marginBottom: 0, width: 64, textAlign: "center", flexShrink: 0 },
          value: cur.emoji,
          onChange: (e) => setEditLabels((prev) => ({ ...prev, [key]: { ...prev[key], emoji: e.target.value } })),
          placeholder: def.emoji,
          maxLength: 4
        }
      ), /* @__PURE__ */ React.createElement("span", { style: {
        background: cur.bg,
        color: cur.color,
        borderRadius: 20,
        padding: "4px 12px",
        fontSize: "0.78rem",
        fontWeight: 800,
        whiteSpace: "nowrap",
        flexShrink: 0
      } }, cur.label || def.label, " ", cur.emoji || def.emoji)));
    }), labelSaved && /* @__PURE__ */ React.createElement("div", { style: { color: "#0d6e4f", fontWeight: 800, fontSize: "0.9rem", textAlign: "center", marginBottom: 8 } }, "\u2713 Labels saved!"), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnPrimary, width: "100%", marginTop: 4 }, onClick: handleSaveLabels }, "Save Labels \u2713"), /* @__PURE__ */ React.createElement(
      "button",
      {
        style: { ...S.btnSecondary, width: "100%", marginTop: 8 },
        onClick: () => {
          const reset = { ...DEFAULT_MASTERY_LABELS };
          setEditLabels(reset);
          onUpdateLabels(reset);
        }
      },
      "Reset to Defaults"
    ))));
  }
  function MathAdventure() {
    const [profiles, setProfilesRaw] = useState(() => loadProfiles());
    const [activeProfile, setActiveProfile] = useState(null);
    const [screen, setScreen] = useState("home");
    const [gameConfig, setGameConfig] = useState(null);
    const [quizResult, setQuizResult] = useState(null);
    const [showConfetti, setShowConfetti] = useState(false);
    const [country, setCountryRaw] = useState(() => loadCountry());
    const [familyCode, setFamilyCode] = useState(() => loadFamilyCode());
    const [labels, setLabelsRaw] = useState(() => loadCustomLabels());
    const [showFamilySetup, setShowFamilySetup] = useState(!loadFamilyCode());
    const [showParentPin, setShowParentPin] = useState(false);
    const [showAdminPin, setShowAdminPin] = useState(false);
    const [showParent, setShowParent] = useState(false);
    const [showAdmin, setShowAdmin] = useState(false);
    const setCountry = (c) => {
      setCountryRaw(c);
      saveCountry(c);
    };
    const setLabels = (l) => {
      setLabelsRaw(l);
      saveCustomLabels(l);
    };
    const setProfiles = (p) => {
      setProfilesRaw(p);
      saveProfiles(p);
    };
    const patchProfile = (id, fn) => {
      const next = profiles.map((p) => p.id === id ? fn(p) : p);
      setProfiles(next);
      setActiveProfile((prev) => prev?.id === id ? fn(prev) : prev);
    };
    const recordAnswers = (profileId, topic, correct, wrong) => patchProfile(profileId, (p) => {
      const prev = p.topicProgress[topic] || { attempts: 0, correct: 0 };
      return { ...p, topicProgress: {
        ...p.topicProgress,
        [topic]: { attempts: prev.attempts + correct + wrong, correct: prev.correct + correct }
      } };
    });
    const recordQuizResult = (profileId, topics, score, total) => patchProfile(profileId, (p) => ({
      ...p,
      quizHistory: [
        ...p.quizHistory.slice(-49),
        { date: Date.now(), topics, score, total, pct: Math.round(score / total * 100) }
      ]
    }));
    const goHome = () => {
      setScreen("home");
      setActiveProfile(null);
      setGameConfig(null);
      setQuizResult(null);
    };
    const goDash = () => {
      setScreen("dashboard");
      setGameConfig(null);
      setQuizResult(null);
    };
    const handleFamilyComplete = (fc, remoteProfiles) => {
      setFamilyCode(fc);
      if (remoteProfiles) setProfiles(remoteProfiles);
      setShowFamilySetup(false);
    };
    return /* @__PURE__ */ React.createElement(React.Fragment, null, showConfetti && /* @__PURE__ */ React.createElement(Confetti, null), showFamilySetup && /* @__PURE__ */ React.createElement(FamilySetup, { onComplete: handleFamilyComplete }), showParentPin && /* @__PURE__ */ React.createElement(
      PinModal,
      {
        title: "Parent & Teacher Mode",
        subtitle: "Enter your parent PIN to continue",
        correctPin: loadParentPin(),
        onSuccess: () => {
          setShowParentPin(false);
          setShowParent(true);
        },
        onCancel: () => setShowParentPin(false)
      }
    ), showAdminPin && /* @__PURE__ */ React.createElement(
      PinModal,
      {
        title: "Admin Mode",
        subtitle: "Enter the admin PIN",
        correctPin: ADMIN_PIN_HASH,
        onSuccess: () => {
          setShowAdminPin(false);
          setShowAdmin(true);
        },
        onCancel: () => setShowAdminPin(false)
      }
    ), showParent && /* @__PURE__ */ React.createElement(
      ParentPanel,
      {
        profiles,
        country,
        familyCode,
        labels,
        onUpdateLabels: (l) => {
          setLabels(l);
        },
        onClose: () => setShowParent(false)
      }
    ), showAdmin && /* @__PURE__ */ React.createElement(AdminPanel, { onClose: () => setShowAdmin(false) }), !showFamilySetup && familyCode && /* @__PURE__ */ React.createElement(FeedbackWidget, { familyCode, profiles }), screen === "home" && /* @__PURE__ */ React.createElement(
      HomeScreen,
      {
        profiles,
        country,
        labels,
        familyCode,
        onSetCountry: setCountry,
        onSelectProfile: (p) => {
          setActiveProfile(p);
          setScreen("dashboard");
        },
        onCreateProfile: () => setScreen("createProfile"),
        onParentMode: () => setShowParentPin(true),
        onAdminMode: () => setShowAdminPin(true)
      }
    ), screen === "createProfile" && /* @__PURE__ */ React.createElement(
      CreateProfile,
      {
        country,
        onSave: (profile) => {
          const updated = [...profiles, profile];
          setProfiles(updated);
          setActiveProfile(profile);
          setScreen("dashboard");
        },
        onBack: () => setScreen("home")
      }
    ), screen === "dashboard" && activeProfile && /* @__PURE__ */ React.createElement(
      Dashboard,
      {
        profile: activeProfile,
        country,
        labels,
        onFlash: () => setScreen("flashSetup"),
        onQuiz: () => setScreen("quizSetup"),
        onProgress: () => setScreen("profileView"),
        onEdit: () => setScreen("editProfile"),
        onHome: goHome
      }
    ), screen === "flashSetup" && activeProfile && /* @__PURE__ */ React.createElement(
      FlashSetup,
      {
        profile: activeProfile,
        country,
        onStart: (cfg) => {
          setGameConfig(cfg);
          setScreen("flashGame");
        },
        onBack: goDash
      }
    ), screen === "quizSetup" && activeProfile && /* @__PURE__ */ React.createElement(
      QuizSetup,
      {
        profile: activeProfile,
        country,
        onStart: (cfg) => {
          setGameConfig(cfg);
          setScreen("quizGame");
        },
        onBack: goDash
      }
    ), screen === "flashGame" && gameConfig && /* @__PURE__ */ React.createElement(FlashGame, { config: gameConfig, onExit: goDash }), screen === "quizGame" && gameConfig && /* @__PURE__ */ React.createElement(
      QuizGame,
      {
        config: gameConfig,
        onComplete: (result) => {
          const topicMap = {};
          result.answers.forEach(({ topic, correct }) => {
            if (!topicMap[topic]) topicMap[topic] = { correct: 0, wrong: 0 };
            correct ? topicMap[topic].correct++ : topicMap[topic].wrong++;
          });
          Object.entries(topicMap).forEach(([t, v]) => recordAnswers(activeProfile.id, t, v.correct, v.wrong));
          recordQuizResult(activeProfile.id, gameConfig.topics, result.score, result.total);
          setQuizResult(result);
          if (result.pct >= 80) {
            setShowConfetti(true);
            setTimeout(() => setShowConfetti(false), 3500);
          }
          setScreen("quizResult");
        },
        onExit: goDash
      }
    ), screen === "quizResult" && quizResult && /* @__PURE__ */ React.createElement(
      QuizResult,
      {
        result: quizResult,
        onRetry: () => {
          setQuizResult(null);
          setGameConfig(null);
          setScreen("quizSetup");
        },
        onHome: goDash
      }
    ), screen === "profileView" && activeProfile && /* @__PURE__ */ React.createElement(
      ProfileView,
      {
        profile: activeProfile,
        country,
        labels,
        onBack: goDash,
        onDelete: () => {
          if (window.confirm(`Delete ${activeProfile.name}'s profile? This can't be undone.`)) {
            setProfiles(profiles.filter((p) => p.id !== activeProfile.id));
            goHome();
          }
        }
      }
    ), screen === "editProfile" && activeProfile && /* @__PURE__ */ React.createElement(
      EditProfile,
      {
        profile: activeProfile,
        country,
        onSave: (updated) => {
          patchProfile(activeProfile.id, () => updated);
          setScreen("dashboard");
        },
        onBack: goDash
      }
    ));
  }
  function HomeScreen({ profiles, country, labels, familyCode, onSetCountry, onSelectProfile, onCreateProfile, onParentMode, onAdminMode }) {
    const cl = COUNTRY_LABELS[country];
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", padding: "36px 0 16px", animation: "fadeUp 0.5s ease" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3rem", marginBottom: 6 } }, "\u{1F31F}"), /* @__PURE__ */ React.createElement("h1", { style: {
      fontFamily: "'Baloo 2',cursive",
      fontSize: "clamp(2.2rem,7vw,3.4rem)",
      fontWeight: 900,
      color: "var(--navy)",
      letterSpacing: "-1px",
      textShadow: "2px 3px 0 rgba(26,58,107,0.1)"
    } }, "Math Adventure"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 700, fontSize: "0.95rem", marginTop: 4 } }, "A joyful homeschool maths companion")), /* @__PURE__ */ React.createElement("div", { style: {
      display: "flex",
      alignItems: "center",
      justifyContent: "space-between",
      marginBottom: 10,
      flexWrap: "wrap",
      gap: 8
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      fontSize: "0.72rem",
      color: "var(--muted)",
      fontWeight: 700,
      background: "#f0f0f0",
      borderRadius: 20,
      padding: "4px 12px",
      letterSpacing: 1
    } }, "\u{1F3E0} ", familyCode), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 6 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.backBtn, fontSize: "0.75rem", padding: "5px 12px" }, onClick: onParentMode }, "\u{1F468}\u200D\u{1F469}\u200D\u{1F467} Parent Mode"), /* @__PURE__ */ React.createElement("button", { style: { ...S.backBtn, fontSize: "0.75rem", padding: "5px 12px", opacity: 0.5 }, onClick: onAdminMode }, "\u{1F6E1}\uFE0F"))), /* @__PURE__ */ React.createElement("div", { style: { ...S.card, padding: "14px 18px", marginBottom: 14, animation: "fadeUp 0.4s 0.05s ease both" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.78rem", fontWeight: 800, color: "var(--muted)", textTransform: "uppercase", letterSpacing: "0.5px", marginBottom: 8 } }, "\u{1F30D} Curriculum"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, flexWrap: "wrap" } }, Object.entries(COUNTRY_LABELS).map(([code, cl2]) => /* @__PURE__ */ React.createElement("button", { key: code, onClick: () => onSetCountry(code), style: {
      border: `2px solid ${country === code ? "var(--blue)" : "#e0e0e0"}`,
      background: country === code ? "#eaf0ff" : "#fafafa",
      borderRadius: 20,
      padding: "7px 16px",
      fontFamily: "Nunito,sans-serif",
      fontWeight: 800,
      fontSize: "0.88rem",
      color: country === code ? "var(--blue)" : "var(--muted)",
      transition: "all 0.18s"
    } }, cl2.flag, " ", cl2.name))), /* @__PURE__ */ React.createElement("div", { style: { marginTop: 8, fontSize: "0.76rem", color: "var(--muted)", fontWeight: 600 } }, "Showing: ", /* @__PURE__ */ React.createElement("strong", { style: { color: "var(--navy)" } }, cl.flag, " ", cl.name), " grade names \xB7 Ages are always displayed")), profiles.length === 0 ? /* @__PURE__ */ React.createElement("div", { style: { ...S.card, textAlign: "center", animation: "fadeUp 0.5s 0.1s ease both" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "2.8rem", marginBottom: 10 } }, "\u{1F468}\u200D\u{1F469}\u200D\u{1F467}\u200D\u{1F467}"), /* @__PURE__ */ React.createElement("h2", { style: S.cardTitle }, "Welcome, Family!"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", marginBottom: 20, lineHeight: 1.6, fontWeight: 600, fontSize: "0.95rem" } }, "Create a profile for each learner to track progress,", /* @__PURE__ */ React.createElement("br", null), "earn mastery badges, and make maths fun!"), /* @__PURE__ */ React.createElement("button", { style: S.btnPrimary, onClick: onCreateProfile }, "+ Add First Learner")) : /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("div", { style: { ...S.sectionLabel, animation: "fadeUp 0.4s 0.1s ease both" } }, "\u{1F44B} Who's learning today?"), /* @__PURE__ */ React.createElement("div", { style: { display: "grid", gridTemplateColumns: "repeat(auto-fill,minmax(130px,1fr))", gap: 12, marginBottom: 16 } }, profiles.map((p, i) => {
      const grade = GRADES.find((g) => g.id === p.gradeId);
      return /* @__PURE__ */ React.createElement(
        "button",
        {
          key: p.id,
          style: {
            ...S.profileCard,
            borderColor: grade?.color || "#ddd",
            animation: `fadeUp 0.4s ${0.1 + i * 0.07}s ease both`
          },
          onClick: () => onSelectProfile(p)
        },
        /* @__PURE__ */ React.createElement("div", { style: { fontSize: "2.4rem", marginBottom: 5 } }, p.avatar),
        /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.95rem", color: "var(--text)" } }, p.name),
        /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.72rem", color: "var(--muted)", fontWeight: 700, marginTop: 2 } }, getGradeName(p.gradeId, country)),
        /* @__PURE__ */ React.createElement("div", { style: {
          marginTop: 5,
          background: (grade?.color || "#ccc") + "33",
          color: grade?.color,
          borderRadius: 20,
          padding: "2px 10px",
          fontSize: "0.68rem",
          fontWeight: 800
        } }, grade?.emoji, " ", getGradeLabel(p.gradeId, country), " \xB7 ", grade?.age)
      );
    }), /* @__PURE__ */ React.createElement(
      "button",
      {
        style: { ...S.addProfileBtn, animation: `fadeUp 0.4s ${0.1 + profiles.length * 0.07}s ease both` },
        onClick: onCreateProfile
      },
      /* @__PURE__ */ React.createElement("span", { style: { fontSize: "1.7rem" } }, "\uFF0B"),
      /* @__PURE__ */ React.createElement("span", { style: { fontWeight: 800, fontSize: "0.82rem", color: "var(--muted)" } }, "Add Learner")
    ))));
  }
  function CreateProfile({ country, onSave, onBack }) {
    const [name, setName] = useState("");
    const [gradeId, setGradeId] = useState("3");
    const [avatar, setAvatar] = useState("\u{1F98B}");
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { ...S.card, animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onBack }, "\u2190 Back"), /* @__PURE__ */ React.createElement("h2", { style: { ...S.cardTitle, marginTop: 12, marginBottom: 20 } }, "\u2728 Create a Learner Profile"), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Name"), /* @__PURE__ */ React.createElement(
      "input",
      {
        style: S.input,
        placeholder: "e.g. Emma",
        value: name,
        onChange: (e) => setName(e.target.value),
        maxLength: 20
      }
    ), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Year / Class"), /* @__PURE__ */ React.createElement("div", { style: { display: "grid", gridTemplateColumns: "repeat(4,1fr)", gap: 6, marginBottom: 20 } }, GRADES.map((g) => /* @__PURE__ */ React.createElement("button", { key: g.id, onClick: () => setGradeId(g.id), style: {
      border: `3px solid ${gradeId === g.id ? g.color : "#e0e0e0"}`,
      background: gradeId === g.id ? g.color + "22" : "#fafafa",
      borderRadius: 12,
      padding: "8px 4px",
      fontFamily: "Nunito,sans-serif",
      transition: "all 0.18s"
    } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "1.1rem" } }, g.emoji), /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.78rem", color: "var(--text)", lineHeight: 1.2 } }, getGradeLabel(g.id, country)), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.58rem", color: "var(--muted)", marginTop: 1 } }, g.age)))), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Choose an Avatar"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8, marginBottom: 24 } }, AVATARS.map((av) => /* @__PURE__ */ React.createElement("button", { key: av, onClick: () => setAvatar(av), style: {
      fontSize: "1.8rem",
      border: `3px solid ${avatar === av ? "var(--mint)" : "transparent"}`,
      borderRadius: 12,
      padding: "6px",
      background: avatar === av ? "#e8fdf6" : "transparent",
      transition: "all 0.15s"
    } }, av))), /* @__PURE__ */ React.createElement(
      "button",
      {
        style: { ...S.btnPrimary, width: "100%", opacity: name.trim() ? 1 : 0.5 },
        disabled: !name.trim(),
        onClick: () => onSave(makeProfile(name.trim(), gradeId, avatar))
      },
      "Create Profile \u{1F389}"
    )));
  }
  function EditProfile({ profile, country, onSave, onBack }) {
    const [name, setName] = useState(profile.name);
    const [gradeId, setGradeId] = useState(profile.gradeId);
    const [avatar, setAvatar] = useState(profile.avatar);
    const hasChanges = name.trim() !== profile.name || gradeId !== profile.gradeId || avatar !== profile.avatar;
    const gradeChanged = gradeId !== profile.gradeId;
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { ...S.card, animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onBack }, "\u2190 Back"), /* @__PURE__ */ React.createElement("h2", { style: { ...S.cardTitle, marginTop: 12, marginBottom: 4 } }, "\u270F\uFE0F Edit Profile"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.84rem", marginBottom: 20, lineHeight: 1.5 } }, "Update ", profile.name, "'s name, year, or avatar anytime."), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Name"), /* @__PURE__ */ React.createElement(
      "input",
      {
        style: S.input,
        value: name,
        onChange: (e) => setName(e.target.value),
        maxLength: 20
      }
    ), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Year / Class"), /* @__PURE__ */ React.createElement("div", { style: { display: "grid", gridTemplateColumns: "repeat(4,1fr)", gap: 6, marginBottom: gradeChanged ? 8 : 20 } }, GRADES.map((g) => /* @__PURE__ */ React.createElement("button", { key: g.id, onClick: () => setGradeId(g.id), style: {
      border: `3px solid ${gradeId === g.id ? g.color : "#e0e0e0"}`,
      background: gradeId === g.id ? g.color + "22" : "#fafafa",
      borderRadius: 12,
      padding: "8px 4px",
      fontFamily: "Nunito,sans-serif",
      transition: "all 0.18s"
    } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "1.1rem" } }, g.emoji), /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.78rem", color: "var(--text)", lineHeight: 1.2 } }, getGradeLabel(g.id, country)), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.58rem", color: "var(--muted)", marginTop: 1 } }, g.age)))), gradeChanged && /* @__PURE__ */ React.createElement("div", { style: {
      background: "#fff8e1",
      border: "2px solid #FFD166",
      borderRadius: 12,
      padding: "10px 14px",
      marginBottom: 20,
      fontSize: "0.8rem",
      fontWeight: 700,
      color: "#856404",
      lineHeight: 1.5
    } }, "\u{1F4DA} Switching year will show new topics on the dashboard. Quiz history is kept safe!"), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Avatar"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8, marginBottom: 24 } }, AVATARS.map((av) => /* @__PURE__ */ React.createElement("button", { key: av, onClick: () => setAvatar(av), style: {
      fontSize: "1.8rem",
      border: `3px solid ${avatar === av ? "var(--mint)" : "transparent"}`,
      borderRadius: 12,
      padding: "6px",
      background: avatar === av ? "#e8fdf6" : "transparent",
      transition: "all 0.15s"
    } }, av))), /* @__PURE__ */ React.createElement(
      "button",
      {
        style: { ...S.btnPrimary, width: "100%", opacity: name.trim() && hasChanges ? 1 : 0.45 },
        disabled: !name.trim() || !hasChanges,
        onClick: () => onSave({ ...profile, name: name.trim(), gradeId, avatar })
      },
      "Save Changes \u2713"
    )));
  }
  function Dashboard({ profile, country, labels, onFlash, onQuiz, onProgress, onEdit, onHome }) {
    const grade = GRADES.find((g) => g.id === profile.gradeId);
    const gradeName = getGradeName(profile.gradeId, country);
    const gradeLabel = getGradeLabel(profile.gradeId, country);
    const recentPct = profile.quizHistory.length > 0 ? Math.round(profile.quizHistory.slice(-5).reduce((s, q) => s + q.pct, 0) / Math.min(5, profile.quizHistory.length)) : null;
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 14, flexWrap: "wrap", gap: 8 } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onHome }, "\u2190 Home"), /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onProgress }, "\u{1F4CA} Progress")), /* @__PURE__ */ React.createElement("style", null, `.profile-edit-btn:active { transform: scale(0.97) !important; box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important; } .profile-edit-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 28px rgba(0,0,0,0.13) !important; }`), /* @__PURE__ */ React.createElement("button", { className: "profile-edit-btn", onClick: onEdit, style: {
      ...S.card,
      width: "100%",
      textAlign: "left",
      cursor: "pointer",
      background: `linear-gradient(135deg,${grade.color}22,#fffdf9)`,
      borderColor: grade.color,
      animation: "fadeUp 0.4s ease",
      position: "relative",
      transition: "box-shadow 0.18s, transform 0.15s",
      display: "block"
    } }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 14, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3.2rem" } }, profile.avatar), /* @__PURE__ */ React.createElement("div", { style: { flex: 1 } }, /* @__PURE__ */ React.createElement("h2", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.55rem", color: "var(--text)", fontWeight: 800 } }, "Hi, ", profile.name, "! \u{1F44B}"), /* @__PURE__ */ React.createElement("div", { style: { color: "var(--muted)", fontWeight: 700, fontSize: "0.88rem" } }, grade.emoji, " ", gradeName, " \xB7 Age ", grade.age), recentPct !== null && /* @__PURE__ */ React.createElement("div", { style: {
      marginTop: 5,
      display: "inline-block",
      background: "#fff",
      borderRadius: 20,
      padding: "3px 12px",
      fontSize: "0.78rem",
      fontWeight: 800,
      color: grade.color,
      border: `2px solid ${grade.color}44`
    } }, "Recent avg: ", recentPct, "% \u2728")), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "1.1rem", opacity: 0.35, flexShrink: 0 } }, "\u270F\uFE0F")), /* @__PURE__ */ React.createElement("div", { style: { marginTop: 8, fontSize: "0.72rem", color: "var(--muted)", fontWeight: 600, opacity: 0.7, textAlign: "right" } }, "Tap to edit profile")), /* @__PURE__ */ React.createElement("div", { style: S.sectionLabel }, "\u{1F3AE} What would you like to do?"), /* @__PURE__ */ React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 14, marginBottom: 18 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.modeCard, borderColor: "#FFD166", animation: "fadeUp 0.4s 0.1s ease both" }, onClick: onFlash }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "2.6rem" } }, "\u26A1"), /* @__PURE__ */ React.createElement("span", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.15rem", fontWeight: 800, color: "var(--text)" } }, "Flash Cards"), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.75rem", color: "var(--muted)", fontWeight: 700 } }, "Practice at your own pace")), /* @__PURE__ */ React.createElement("button", { style: { ...S.modeCard, borderColor: "#9B5DE5", animation: "fadeUp 0.4s 0.15s ease both" }, onClick: onQuiz }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "2.6rem" } }, "\u{1F9E0}"), /* @__PURE__ */ React.createElement("span", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.15rem", fontWeight: 800, color: "var(--text)" } }, "Quiz Mode"), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.75rem", color: "var(--muted)", fontWeight: 700 } }, "Answer & earn stars"))), /* @__PURE__ */ React.createElement("div", { style: { ...S.card, animation: "fadeUp 0.4s 0.2s ease both" } }, /* @__PURE__ */ React.createElement("div", { style: S.cardTitle }, "\u{1F4DA} ", gradeName, " Topics"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 10, marginTop: 10 } }, grade.topics.map((t) => {
      const status = getTopicMastery(profile, t);
      const pct = getTopicPct(profile, t);
      return /* @__PURE__ */ React.createElement("div", { key: t, style: { display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "1rem", width: 22, flexShrink: 0 } }, TOPIC_EMOJIS[t]), /* @__PURE__ */ React.createElement("span", { style: { fontWeight: 700, fontSize: "0.87rem", flex: 1, minWidth: 80 } }, TOPIC_LABELS[t]), pct !== null && /* @__PURE__ */ React.createElement(ProgressBar, { pct, color: grade.color }), /* @__PURE__ */ React.createElement(MasteryBadge, { status, labels }));
    }))));
  }
  function FlashSetup({ profile, country, onStart, onBack }) {
    const grade = GRADES.find((g) => g.id === profile.gradeId);
    const [selTopics, setSelTopics] = useState([...grade.topics]);
    const toggleT = (t) => setSelTopics(
      (prev) => prev.includes(t) ? prev.length > 1 ? prev.filter((x) => x !== t) : prev : [...prev, t]
    );
    const handleStart = () => {
      const perTopic = Math.max(3, Math.ceil(20 / selTopics.length));
      const problems = [];
      selTopics.forEach((t) => {
        for (let i = 0; i < perTopic; i++) problems.push(generateProblem(t, "medium"));
      });
      onStart({ topics: selTopics, problems: smartShuffle(problems) });
    };
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onBack }, "\u2190 Back"), /* @__PURE__ */ React.createElement("div", { style: { ...S.card, marginTop: 12, animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("div", { style: S.cardTitle }, "\u26A1 Flash Card Setup"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.87rem", marginBottom: 16, lineHeight: 1.5 } }, "Which topics would you like to practice today?"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8, marginBottom: 24 } }, grade.topics.map((t) => {
      const active = selTopics.includes(t);
      return /* @__PURE__ */ React.createElement("button", { key: t, onClick: () => toggleT(t), style: {
        border: `2px solid ${active ? "#e6a800" : "#e0e0e0"}`,
        background: active ? "#fff8e1" : "#fafafa",
        borderRadius: 30,
        padding: "7px 14px",
        fontFamily: "Nunito,sans-serif",
        fontWeight: 700,
        fontSize: "0.83rem",
        color: active ? "#7a5000" : "var(--muted)",
        transition: "all 0.18s"
      } }, TOPIC_EMOJIS[t], " ", TOPIC_LABELS[t]);
    })), /* @__PURE__ */ React.createElement(
      "button",
      {
        style: {
          ...S.btnPrimary,
          width: "100%",
          background: "#e6a800",
          boxShadow: "0 4px 14px rgba(230,168,0,0.35)"
        },
        onClick: handleStart
      },
      "Start Flash Cards! \u26A1"
    )));
  }
  function QuizSetup({ profile, country, onStart, onBack }) {
    const grade = GRADES.find((g) => g.id === profile.gradeId);
    const [selTopics, setSelTopics] = useState([...grade.topics]);
    const [difficulty, setDifficulty] = useState("medium");
    const [qCount, setQCount] = useState(10);
    const toggleT = (t) => setSelTopics(
      (prev) => prev.includes(t) ? prev.length > 1 ? prev.filter((x) => x !== t) : prev : [...prev, t]
    );
    const handleStart = () => {
      const problems = [];
      for (let i = 0; i < qCount; i++) problems.push(generateProblem(selTopics[i % selTopics.length], difficulty));
      for (let i = problems.length - 1; i > 0; i--) {
        const j = rnd(0, i);
        [problems[i], problems[j]] = [problems[j], problems[i]];
      }
      onStart({ topics: selTopics, difficulty, qCount, problems });
    };
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onBack }, "\u2190 Back"), /* @__PURE__ */ React.createElement("div", { style: { ...S.card, marginTop: 12, animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("div", { style: S.cardTitle }, "\u{1F9E0} Quiz Setup"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 600, fontSize: "0.87rem", marginBottom: 16, lineHeight: 1.5 } }, "Focus on the topics you want to strengthen \u2014 pick as many or as few as you like!"), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Topics"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: 8, marginBottom: 20 } }, grade.topics.map((t) => {
      const status = getTopicMastery(profile, t);
      const active = selTopics.includes(t);
      return /* @__PURE__ */ React.createElement("button", { key: t, onClick: () => toggleT(t), style: {
        border: `2px solid ${active ? "var(--mint)" : "#e0e0e0"}`,
        background: active ? "#e8fdf6" : "#fafafa",
        borderRadius: 30,
        padding: "7px 14px",
        fontFamily: "Nunito,sans-serif",
        fontWeight: 700,
        fontSize: "0.83rem",
        color: active ? "#0d6e4f" : "var(--muted)",
        transition: "all 0.18s",
        display: "flex",
        alignItems: "center",
        gap: 5
      } }, TOPIC_EMOJIS[t], " ", TOPIC_LABELS[t], status === "growing" && /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.6rem", color: "var(--coral)" } }, "\u25CF"));
    })), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Number of Questions"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, marginBottom: 20, flexWrap: "wrap" } }, [5, 10, 15, 20].map((n) => /* @__PURE__ */ React.createElement("button", { key: n, onClick: () => setQCount(n), style: {
      border: `2px solid ${qCount === n ? "var(--blue)" : "#e0e0e0"}`,
      background: qCount === n ? "#eaf0ff" : "#fafafa",
      borderRadius: 20,
      padding: "8px 18px",
      fontFamily: "Nunito,sans-serif",
      fontWeight: 800,
      color: qCount === n ? "var(--blue)" : "var(--muted)",
      transition: "all 0.18s"
    } }, n))), /* @__PURE__ */ React.createElement("label", { style: S.inputLabel }, "Difficulty"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, marginBottom: 24, flexWrap: "wrap" } }, [["easy", "\u{1F60A} Easy"], ["medium", "\u{1F31F} Medium"], ["hard", "\u{1F525} Hard"]].map(([val, lab]) => /* @__PURE__ */ React.createElement("button", { key: val, onClick: () => setDifficulty(val), style: {
      border: `2px solid ${difficulty === val ? "var(--purple)" : "#e0e0e0"}`,
      background: difficulty === val ? "#f0e6ff" : "#fafafa",
      borderRadius: 20,
      padding: "8px 18px",
      fontFamily: "Nunito,sans-serif",
      fontWeight: 800,
      color: difficulty === val ? "var(--purple)" : "var(--muted)",
      transition: "all 0.18s"
    } }, lab))), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnPrimary, width: "100%" }, onClick: handleStart }, "Start Quiz! \u{1F680}")));
  }
  function FlashGame({ config, onExit }) {
    const [idx, setIdx] = useState(0);
    const [flipped, setFlipped] = useState(false);
    const problems = config.problems;
    const next = () => {
      setFlipped(false);
      setIdx((i) => (i + 1) % problems.length);
    };
    const prev = () => {
      setFlipped(false);
      setIdx((i) => (i - 1 + problems.length) % problems.length);
    };
    const shuffle = () => {
      const reshuffled = smartShuffle([...problems]);
      reshuffled.forEach((p, i) => {
        problems[i] = p;
      });
      setIdx(0);
      setFlipped(false);
    };
    useEffect(() => {
      const h = (e) => {
        if (e.key === "ArrowRight" || e.key === "n") next();
        else if (e.key === "ArrowLeft" || e.key === "p") prev();
        else if (e.key === " " || e.key === "Enter") {
          e.preventDefault();
          setFlipped((f) => !f);
        }
      };
      window.addEventListener("keydown", h);
      return () => window.removeEventListener("keydown", h);
    });
    const prob = problems[idx];
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 12 } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onExit }, "\u2715 Exit"), /* @__PURE__ */ React.createElement("span", { style: { fontWeight: 800, color: "var(--muted)", fontSize: "0.88rem" } }, idx + 1, " / ", problems.length), /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: shuffle }, "\u{1F500} Shuffle")), /* @__PURE__ */ React.createElement("div", { onClick: () => setFlipped((f) => !f), style: {
      background: "linear-gradient(135deg,#fff8e1,#fffde7)",
      border: "3px solid #FFD166",
      borderRadius: 24,
      padding: "40px 24px",
      cursor: "pointer",
      minHeight: 210,
      display: "flex",
      flexDirection: "column",
      alignItems: "center",
      justifyContent: "center",
      boxShadow: "0 6px 28px rgba(255,209,102,0.22)",
      userSelect: "none",
      animation: "fadeUp 0.3s ease"
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      fontFamily: "'Baloo 2',cursive",
      fontSize: "clamp(1.7rem,6vw,3rem)",
      color: "var(--text)",
      fontWeight: 800,
      textAlign: "center",
      whiteSpace: "pre-line",
      lineHeight: 1.3
    } }, prob.question), prob.hint && !flipped && /* @__PURE__ */ React.createElement("div", { style: { color: "var(--muted)", fontSize: "0.8rem", fontWeight: 700, marginTop: 8, textAlign: "center" } }, prob.hint), flipped ? /* @__PURE__ */ React.createElement("div", { style: {
      marginTop: 14,
      fontFamily: "'Baloo 2',cursive",
      fontSize: "2.4rem",
      color: "var(--mint)",
      fontWeight: 900,
      animation: "pop 0.3s ease",
      textAlign: "center"
    } }, "= ", prob.answer) : /* @__PURE__ */ React.createElement("div", { style: { color: "#ccc", fontSize: "0.82rem", fontWeight: 700, marginTop: 14, textAlign: "center" } }, "Tap to reveal \u2728")), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginTop: 14 } }, /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, padding: "10px 20px" }, onClick: prev }, "\u2190 Prev"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 5, flexWrap: "wrap", justifyContent: "center", maxWidth: 200 } }, problems.map((_, i) => /* @__PURE__ */ React.createElement("div", { key: i, style: {
      width: 7,
      height: 7,
      borderRadius: "50%",
      flexShrink: 0,
      background: i === idx ? "var(--blue)" : "#ddd",
      transition: "background 0.2s"
    } }))), /* @__PURE__ */ React.createElement("button", { style: { ...S.btnSecondary, padding: "10px 20px" }, onClick: next }, "Next \u2192")), /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", marginTop: 8, fontSize: "0.72rem", color: "#ccc", fontWeight: 600 } }, "Keyboard: \u2190 \u2192 to navigate \xB7 Space to flip"));
  }
  function QuizGame({ config, onComplete, onExit }) {
    const [idx, setIdx] = useState(0);
    const [score, setScore] = useState(0);
    const [answers, setAnswers] = useState([]);
    const [chosen, setChosen] = useState(null);
    const [choices, setChoices] = useState(() => generateChoices(config.problems[0].answer));
    const [feedback, setFeedback] = useState(null);
    const prob = config.problems[idx];
    useEffect(() => {
      setChosen(null);
      setFeedback(null);
      setChoices(generateChoices(prob.answer));
    }, [idx]);
    const handleAnswer = (c) => {
      if (chosen !== null) return;
      const correct = String(c) === String(prob.answer);
      setChosen(c);
      setFeedback(correct ? "correct" : "wrong");
      const newScore = correct ? score + 1 : score;
      const newAnswers = [...answers, { topic: prob.topic, correct }];
      if (correct) setScore(newScore);
      setTimeout(() => {
        if (idx + 1 >= config.problems.length) {
          onComplete({
            score: newScore,
            total: config.problems.length,
            pct: Math.round(newScore / config.problems.length * 100),
            answers: newAnswers
          });
        } else {
          setAnswers(newAnswers);
          setIdx((i) => i + 1);
        }
      }, 1200);
    };
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 10, flexWrap: "wrap", gap: 8 } }, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onExit }, "\u2715 Exit"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 8, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("span", { style: { ...S.badge, background: "#eaf0ff", color: "var(--blue)" } }, "Q ", idx + 1, "/", config.problems.length), /* @__PURE__ */ React.createElement("span", { style: { ...S.badge, background: "#d4f7ec", color: "#0d6e4f" } }, "\u2705 ", score))), /* @__PURE__ */ React.createElement("div", { style: { marginBottom: 14 } }, /* @__PURE__ */ React.createElement(ProgressBar, { pct: idx / config.problems.length * 100, color: "var(--blue)", height: 10 })), /* @__PURE__ */ React.createElement("div", { style: {
      background: "linear-gradient(135deg,#f0f8ff,#fff)",
      border: "3px solid #ddeeff",
      borderRadius: 24,
      padding: "26px 20px",
      marginBottom: 18,
      textAlign: "center",
      boxShadow: "0 4px 20px rgba(45,107,228,0.09)",
      animation: "fadeUp 0.3s ease"
    } }, /* @__PURE__ */ React.createElement("div", { style: {
      fontFamily: "'Baloo 2',cursive",
      fontSize: "clamp(1.8rem,6vw,3.2rem)",
      color: "var(--text)",
      fontWeight: 900,
      letterSpacing: 1,
      whiteSpace: "pre-line",
      lineHeight: 1.3
    } }, prob.question), prob.hint && /* @__PURE__ */ React.createElement("div", { style: { color: "var(--muted)", fontSize: "0.8rem", fontWeight: 700, marginTop: 8 } }, prob.hint)), /* @__PURE__ */ React.createElement("div", { style: { display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12 } }, choices.map((c, i) => {
      const isChosen = chosen !== null && String(chosen) === String(c);
      const isCorrect = String(c) === String(prob.answer);
      let border = "#e0e0e0", bg = "#fafafa", col = "var(--text)";
      if (chosen !== null) {
        if (isCorrect) {
          border = "var(--mint)";
          bg = "#d4f7ec";
          col = "#0d6e4f";
        } else if (isChosen) {
          border = "var(--coral)";
          bg = "#fde8ed";
          col = "#cc2244";
        }
      }
      return /* @__PURE__ */ React.createElement(
        "button",
        {
          key: i,
          disabled: chosen !== null,
          onClick: () => handleAnswer(c),
          style: {
            border: `3px solid ${border}`,
            borderRadius: 16,
            padding: "16px 10px",
            background: bg,
            color: col,
            fontFamily: "'Baloo 2',cursive",
            fontSize: "clamp(1.3rem,4vw,1.8rem)",
            fontWeight: 800,
            transition: "border 0.15s, background 0.15s",
            animation: isChosen && !isCorrect ? "shake 0.35s ease" : isCorrect && chosen ? "pop 0.3s ease" : "none",
            cursor: chosen ? "default" : "pointer"
          },
          onMouseEnter: (e) => {
            if (!chosen) {
              e.currentTarget.style.borderColor = "var(--blue)";
              e.currentTarget.style.background = "#eaf6fd";
            }
          },
          onMouseLeave: (e) => {
            if (!chosen) {
              e.currentTarget.style.borderColor = "#e0e0e0";
              e.currentTarget.style.background = "#fafafa";
            }
          }
        },
        c
      );
    })), feedback && /* @__PURE__ */ React.createElement("div", { style: {
      textAlign: "center",
      marginTop: 14,
      fontFamily: "'Baloo 2',cursive",
      fontSize: "1.2rem",
      fontWeight: 800,
      animation: "fadeUp 0.2s ease",
      color: feedback === "correct" ? "#0d6e4f" : "#cc4444"
    } }, feedback === "correct" ? ["Great job! \u2728", "Correct! \u{1F389}", "You got it! \u{1F31F}", "Excellent! \u{1F4AB}"][rnd(0, 3)] : `The answer is ${prob.answer} \u2014 you've got this! \u{1F4AA}`));
  }
  function QuizResult({ result, onRetry, onHome }) {
    const { score, total, pct, answers } = result;
    const stars = pct >= 95 ? 3 : pct >= 75 ? 2 : pct >= 50 ? 1 : 0;
    const msgs = pct >= 95 ? ENCOURAGEMENTS.perfect : pct >= 75 ? ENCOURAGEMENTS.great : pct >= 50 ? ENCOURAGEMENTS.good : ENCOURAGEMENTS.growing;
    const message = msgs[rnd(0, msgs.length - 1)];
    const topicAcc = {};
    answers.forEach(({ topic, correct }) => {
      if (!topicAcc[topic]) topicAcc[topic] = { c: 0, t: 0 };
      topicAcc[topic].t++;
      if (correct) topicAcc[topic].c++;
    });
    const weakTopics = Object.entries(topicAcc).filter(([, v]) => v.c / v.t < 0.6).map(([t]) => t);
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("div", { style: { ...S.card, textAlign: "center", animation: "fadeUp 0.4s ease" } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3.2rem", marginBottom: 6, animation: "pop 0.5s ease" } }, pct >= 80 ? "\u{1F389}" : pct >= 50 ? "\u{1F60A}" : "\u{1F4AA}"), /* @__PURE__ */ React.createElement("h2", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.9rem", color: "var(--blue)", fontWeight: 900 } }, message.split("!")[0], "!"), /* @__PURE__ */ React.createElement(Stars, { count: stars }), /* @__PURE__ */ React.createElement("div", { style: {
      fontSize: "1.05rem",
      fontWeight: 800,
      color: "var(--text)",
      margin: "8px 0",
      background: "#f0f8ff",
      borderRadius: 16,
      padding: "10px 18px",
      display: "inline-block"
    } }, score, " out of ", total, " \xB7 ", pct, "%"), /* @__PURE__ */ React.createElement("p", { style: { color: "var(--muted)", fontWeight: 700, fontSize: "0.88rem", marginTop: 8, lineHeight: 1.6 } }, pct >= 80 ? "You're doing brilliantly \u2014 keep up the amazing work! \u{1F31F}" : pct >= 50 ? "You're making real progress! Every practice session builds your skills. \u{1F4AA}" : "Every question you tried made your brain stronger. That's what matters most! \u{1F331}"), /* @__PURE__ */ React.createElement("div", { style: { textAlign: "left", marginTop: 16, marginBottom: 14 } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, color: "var(--text)", marginBottom: 8, fontSize: "0.88rem" } }, "Your results by topic:"), Object.entries(topicAcc).map(([t, v]) => {
      const tPct = Math.round(v.c / v.t * 100);
      return /* @__PURE__ */ React.createElement("div", { key: t, style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 8, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("span", { style: { width: 20, fontSize: "0.95rem", flexShrink: 0 } }, TOPIC_EMOJIS[t]), /* @__PURE__ */ React.createElement("span", { style: { flex: 1, fontWeight: 700, fontSize: "0.83rem", minWidth: 80 } }, TOPIC_LABELS[t]), /* @__PURE__ */ React.createElement(ProgressBar, { pct: tPct, color: tPct >= 80 ? "#06D6A0" : tPct >= 50 ? "#FFD166" : "#FF9F7F" }), /* @__PURE__ */ React.createElement("span", { style: {
        fontSize: "0.78rem",
        fontWeight: 800,
        minWidth: 32,
        textAlign: "right",
        color: tPct >= 80 ? "#0d6e4f" : tPct >= 50 ? "#856404" : "#c0392b"
      } }, tPct, "%"));
    })), weakTopics.length > 0 && /* @__PURE__ */ React.createElement("div", { style: {
      background: "linear-gradient(135deg,#fff8e1,#fffde7)",
      border: "2px solid #FFD166",
      borderRadius: 16,
      padding: 16,
      textAlign: "left",
      marginBottom: 16
    } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, color: "#856404", marginBottom: 10, fontSize: "0.88rem" } }, "\u{1F31F} Want to grow even stronger? Here are some fun ways to practice:"), weakTopics.map((t) => /* @__PURE__ */ React.createElement("div", { key: t, style: { marginBottom: 12 } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.83rem", color: "var(--text)", marginBottom: 4 } }, TOPIC_EMOJIS[t], " ", TOPIC_LABELS[t]), (TOPIC_RESOURCES[t] || []).slice(0, 2).map((r, i) => /* @__PURE__ */ React.createElement("div", { key: i, style: {
      fontSize: "0.79rem",
      color: "var(--muted)",
      fontWeight: 600,
      padding: "3px 0 3px 12px",
      borderLeft: "3px solid #FFD166",
      marginBottom: 3,
      lineHeight: 1.4
    } }, r))))), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 10, justifyContent: "center", flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("button", { style: S.btnPrimary, onClick: onRetry }, "Try Again \u{1F504}"), /* @__PURE__ */ React.createElement("button", { style: S.btnSecondary, onClick: onHome }, "Dashboard \u{1F3E0}"))));
  }
  function ProfileView({ profile, country, labels, onBack, onDelete }) {
    const grade = GRADES.find((g) => g.id === profile.gradeId);
    const gradeName = getGradeName(profile.gradeId, country);
    const masteredCount = grade.topics.filter((t) => getTopicMastery(profile, t) === "mastered").length;
    const recent = profile.quizHistory.slice(-8).reverse();
    return /* @__PURE__ */ React.createElement(Page, null, /* @__PURE__ */ React.createElement("button", { style: S.backBtn, onClick: onBack }, "\u2190 Back"), /* @__PURE__ */ React.createElement("div", { style: {
      ...S.card,
      textAlign: "center",
      marginTop: 12,
      background: `linear-gradient(135deg,${grade.color}22,#fffdf9)`,
      borderColor: grade.color,
      animation: "fadeUp 0.4s ease"
    } }, /* @__PURE__ */ React.createElement("div", { style: { fontSize: "3.2rem" } }, profile.avatar), /* @__PURE__ */ React.createElement("h2", { style: { fontFamily: "'Baloo 2',cursive", fontSize: "1.5rem", color: "var(--text)", fontWeight: 900 } }, profile.name), /* @__PURE__ */ React.createElement("div", { style: { color: "var(--muted)", fontWeight: 700, fontSize: "0.84rem" } }, grade.emoji, " ", gradeName, " \xB7 Age ", grade.age), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", gap: 12, justifyContent: "center", margin: "12px 0", flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("div", { style: { background: "#d4f7ec", color: "#0d6e4f", borderRadius: 20, padding: "4px 14px", fontWeight: 800, fontSize: "0.83rem" } }, "\u{1F3C6} ", masteredCount, " Mastered"), /* @__PURE__ */ React.createElement("div", { style: { background: "#eaf0ff", color: "var(--blue)", borderRadius: 20, padding: "4px 14px", fontWeight: 800, fontSize: "0.83rem" } }, "\u{1F4DD} ", profile.quizHistory.length, " Quizzes"))), /* @__PURE__ */ React.createElement("div", { style: { ...S.card, animation: "fadeUp 0.4s 0.1s ease both" } }, /* @__PURE__ */ React.createElement("div", { style: S.cardTitle }, "\u{1F4CA} Topic Mastery"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 12, marginTop: 10 } }, grade.topics.map((t) => {
      const status = getTopicMastery(profile, t);
      const pct = getTopicPct(profile, t);
      const prog = profile.topicProgress[t];
      return /* @__PURE__ */ React.createElement("div", { key: t }, /* @__PURE__ */ React.createElement("div", { style: { display: "flex", alignItems: "center", gap: 8, marginBottom: 4, flexWrap: "wrap" } }, /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.95rem", flexShrink: 0 } }, TOPIC_EMOJIS[t]), /* @__PURE__ */ React.createElement("span", { style: { flex: 1, fontWeight: 700, fontSize: "0.86rem" } }, TOPIC_LABELS[t]), /* @__PURE__ */ React.createElement(MasteryBadge, { status, labels })), prog && prog.attempts > 0 ? /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(ProgressBar, { pct: pct || 0, color: grade.color }), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.7rem", color: "var(--muted)", fontWeight: 700, marginTop: 2 } }, prog.correct, "/", prog.attempts, " correct (", pct, "%)", status === "mastered" && " \u{1F389}")) : /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.7rem", color: "#ccc", fontWeight: 700 } }, "Not started yet"));
    }))), recent.length > 0 && /* @__PURE__ */ React.createElement("div", { style: { ...S.card, animation: "fadeUp 0.4s 0.2s ease both" } }, /* @__PURE__ */ React.createElement("div", { style: S.cardTitle }, "\u{1F4C5} Recent Quizzes"), /* @__PURE__ */ React.createElement("div", { style: { display: "flex", flexDirection: "column", gap: 8, marginTop: 10 } }, recent.map((q, i) => {
      const d = new Date(q.date);
      const stars = q.pct >= 95 ? 3 : q.pct >= 75 ? 2 : q.pct >= 50 ? 1 : 0;
      return /* @__PURE__ */ React.createElement("div", { key: i, style: {
        display: "flex",
        alignItems: "center",
        gap: 10,
        padding: "8px 12px",
        background: "#f9f9f9",
        borderRadius: 12
      } }, /* @__PURE__ */ React.createElement("div", { style: { flex: 1 } }, /* @__PURE__ */ React.createElement("div", { style: { fontWeight: 800, fontSize: "0.84rem", color: "var(--text)" } }, q.score, "/", q.total, " (", q.pct, "%)"), /* @__PURE__ */ React.createElement("div", { style: { fontSize: "0.7rem", color: "var(--muted)", fontWeight: 600 } }, d.toLocaleDateString())), /* @__PURE__ */ React.createElement("span", { style: { fontSize: "0.9rem" } }, "\u2B50".repeat(stars), "\u2606".repeat(3 - stars)), /* @__PURE__ */ React.createElement("div", { style: { width: 60, flexShrink: 0 } }, /* @__PURE__ */ React.createElement(
        ProgressBar,
        {
          pct: q.pct,
          height: 6,
          color: q.pct >= 80 ? "#06D6A0" : q.pct >= 50 ? "#FFD166" : "#FF9F7F"
        }
      )));
    }))), /* @__PURE__ */ React.createElement("div", { style: { textAlign: "center", marginTop: 4, marginBottom: 24 } }, /* @__PURE__ */ React.createElement("button", { onClick: onDelete, style: {
      ...S.btnSecondary,
      color: "#cc4444",
      borderColor: "#ffcccc",
      background: "#fff8f8",
      fontSize: "0.85rem"
    } }, "\u{1F5D1}\uFE0F Delete Profile")));
  }
  const S = {
    card: {
      background: "var(--card)",
      borderRadius: 24,
      boxShadow: "0 4px 24px rgba(0,0,0,0.07)",
      padding: "22px",
      marginBottom: 14,
      border: "2px solid #f0eee8"
    },
    cardTitle: { fontFamily: "'Baloo 2',cursive", fontSize: "1.15rem", fontWeight: 800, color: "var(--navy)", marginBottom: 4 },
    sectionLabel: { fontFamily: "'Baloo 2',cursive", fontWeight: 800, fontSize: "1rem", color: "var(--navy)", marginBottom: 10, marginTop: 4 },
    profileCard: {
      background: "var(--card)",
      border: "3px solid #eee",
      borderRadius: 20,
      padding: "14px 10px",
      display: "flex",
      flexDirection: "column",
      alignItems: "center",
      gap: 4,
      cursor: "pointer",
      transition: "all 0.2s",
      fontFamily: "Nunito,sans-serif",
      boxShadow: "0 2px 10px rgba(0,0,0,0.05)"
    },
    addProfileBtn: {
      background: "#f9f9f9",
      border: "2px dashed #ddd",
      borderRadius: 20,
      padding: "14px 10px",
      display: "flex",
      flexDirection: "column",
      alignItems: "center",
      gap: 6,
      cursor: "pointer",
      transition: "all 0.2s",
      fontFamily: "Nunito,sans-serif"
    },
    modeCard: {
      background: "var(--card)",
      border: "3px solid #eee",
      borderRadius: 20,
      padding: "18px 12px",
      display: "flex",
      flexDirection: "column",
      alignItems: "center",
      gap: 5,
      cursor: "pointer",
      transition: "all 0.2s",
      fontFamily: "Nunito,sans-serif",
      boxShadow: "0 2px 10px rgba(0,0,0,0.05)"
    },
    btnPrimary: {
      background: "var(--blue)",
      color: "#fff",
      border: "none",
      borderRadius: 30,
      padding: "13px 26px",
      fontFamily: "'Baloo 2',cursive",
      fontWeight: 800,
      fontSize: "1rem",
      boxShadow: "0 4px 14px rgba(45,107,228,0.32)",
      transition: "all 0.2s",
      letterSpacing: "0.3px"
    },
    btnSecondary: {
      background: "#f0f0f0",
      color: "#555",
      border: "2px solid #e0e0e0",
      borderRadius: 30,
      padding: "10px 20px",
      fontFamily: "'Baloo 2',cursive",
      fontWeight: 700,
      fontSize: "0.92rem",
      transition: "all 0.2s"
    },
    backBtn: {
      background: "transparent",
      color: "var(--muted)",
      border: "2px solid #e0e0e0",
      borderRadius: 20,
      padding: "7px 14px",
      fontFamily: "Nunito,sans-serif",
      fontWeight: 700,
      fontSize: "0.83rem",
      cursor: "pointer",
      transition: "all 0.18s"
    },
    input: {
      width: "100%",
      border: "2px solid #e0e0e0",
      borderRadius: 12,
      padding: "10px 14px",
      fontSize: "1rem",
      fontFamily: "Nunito,sans-serif",
      fontWeight: 700,
      outline: "none",
      marginBottom: 16,
      background: "#fafafa",
      display: "block"
    },
    inputLabel: {
      display: "block",
      fontWeight: 800,
      color: "var(--muted)",
      fontSize: "0.78rem",
      marginBottom: 6,
      textTransform: "uppercase",
      letterSpacing: "0.5px"
    },
    badge: { borderRadius: 20, padding: "4px 12px", fontWeight: 800, fontSize: "0.8rem", fontFamily: "Nunito,sans-serif" }
  };
  const domRoot = ReactDOM.createRoot(document.getElementById("root"));
  domRoot.render(React.createElement(MathAdventure));
  </script>
</body>
</html>